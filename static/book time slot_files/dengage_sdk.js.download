(function(){'use strict';function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function(obj){return typeof obj}}else{_typeof=function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function(){};return{s:F,n:function(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function(e){throw e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function(){it=o[Symbol.iterator]()},n:function(){var step=it.next();normalCompletion=step.done;return step},e:function(e){didErr=true;err=e},f:function(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function toInt$1(input){if(typeof input=='number'){return input}if(typeof input=='string'){return input===''?0:parseInt(input)}return 0}var storage={isAvailable:function isAvailable(){try{sessionStorage.getItem('dengage_subscription_sent');localStorage.setItem('dengage_device_id',localStorage.getItem('dengage_device_id'));return true}catch(e){return false}},get:function get(key){try{return localStorage.getItem(key)}catch(e){return null}},set:function set(key,value){try{localStorage.setItem(key,value)}catch(e){}},getInt:function getInt(key){try{return toInt$1(localStorage.getItem(key))}catch(e){return 0}},sessionGet:function sessionGet(key){try{return sessionStorage.getItem(key)}catch(e){return null}},sessionSet:function sessionSet(key,value){try{sessionStorage.setItem(key,value)}catch(e){}}};function deepCopy(input){return JSON.parse(JSON.stringify(input))}function objectAssign(target,varArgs){if(target===null||target===undefined){throw new TypeError('Cannot convert undefined or null to object')}var to=Object(target);for(var index=1;index<arguments.length;index++){var nextSource=arguments[index];if(nextSource!==null&&nextSource!==undefined){for(var nextKey in nextSource){if(Object.prototype.hasOwnProperty.call(nextSource,nextKey)&&nextSource[nextKey]!==undefined){to[nextKey]=nextSource[nextKey]}}}}return to}function shadeHexColor(color,percent){var f=parseInt(color.slice(1),16),t=percent<0?0:255,p=percent<0?percent*-1:percent,R=f>>16,G=f>>8&255,B=f&255;return"#"+(16777216+(Math.round((t-R)*p)+R)*65536+(Math.round((t-G)*p)+G)*256+(Math.round((t-B)*p)+B)).toString(16).slice(1)}function getFontFamily(font){switch(font){case'ARIAL':return'Helvetica, Arial, sans-serif';case'TAHOMA':return'Tahoma, sans-serif';case'VERDANA':return'Verdana, sans-serif';case'GEORGIA':return'Georgia, Times, serif';case'TIMES':return'"Times New Roman", Times, serif';case'COURIER':return'"Courier New", Courier, monospace'}return'inherit'}function generateUUID(){return'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,(function(c){var r=Math.random()*16|0,v=c=='x'?r:r&3|8;return v.toString(16).toLowerCase()}))}function setLogLevel(level){if(level=='info'||level=='error'||level=='none'){storage.set('dengage_log_level',level);window._Dn_globaL_.logLevel=level}else{console.error('dengage: wrong log level')}}function getLogLevel(){if(!window._Dn_globaL_.logLevel){window._Dn_globaL_.logLevel=storage.get('dengage_log_level');if(storage.get('dn_debug')=='true'){window._Dn_globaL_.logLevel='info'}}return window._Dn_globaL_.logLevel}function logError(){if(getLogLevel()!='none'){var _console;for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}(_console=console).error.apply(_console,['dengage: '].concat(args))}}function logInfo(){if(getLogLevel()=='info'){var _console2;for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2]}(_console2=console).log.apply(_console2,['dengage: '].concat(args))}}function errorLoggerResolved(errorText,resolveValue){return function(input){logError(errorText,input);return resolveValue}}function errorLoggerRejected(errorText,rejectValue){return function(input){logError(errorText,input);return Promise.reject(rejectValue)}}function arrayBufferToBase64(buffer){var binary='';var bytes=new Uint8Array(buffer);var len=bytes.byteLength;for(var i=0;i<len;i++){binary+=String.fromCharCode(bytes[i])}return window.btoa(binary)}function base64Normalize(input){return input.replace(/\-/g,'+').replace(/\_/g,'/').replace(/^\=+|\=+$/g,'')}function getQueryStringParameter(name,url){if(!url)url=window.location.href;name=name.replace(/[\[\]]/g,'\\$&');var regex=new RegExp('[?&]'+name+'(=([^&#]*)|&|#|$)'),results=regex.exec(url);if(!results)return null;if(!results[2])return'';return decodeURIComponent(results[2].replace(/\+/g,' '))}function isIsoDate(str){if(!/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z/.test(str))return false;var d=new Date(str);return d.toISOString()===str}function isBlinkBrowser(){var isOpera=!!window.opr&&!!opr.addons||!!window.opera||navigator.userAgent.indexOf(' OPR/')>=0;var isChrome=!!window.chrome&&(!!window.chrome.webstore||!!window.chrome.runtime);return(isChrome||isOpera)&&!!window.CSS}function isFirefoxBrowser(){return typeof InstallTrigger!=='undefined'}function runOnWindowLoaded(func){if(document.readyState=='complete'){func()}else{window.addEventListener('load',(function(){func()}))}}function findParentDomain(domains){if(_typeof(domains)!='object'||domains.length==0){return''}if(domains.length==1){return domains[0]}var level=0;while(true){var parts=domains.map((function(d){return d.split('.').reverse()[level]}));var allEqual=true;for(var i=1;i<parts.length;i++){if(parts[i]!=parts[i-1]){allEqual=false}}if(allEqual){level++}else{break}}return domains[0].split('.').reverse().slice(0,level).reverse().join('.')}function getCookie(name){var cookieArr=document.cookie.split(";");for(var i=0;i<cookieArr.length;i++){var cookiePair=cookieArr[i].split("=");if(name==cookiePair[0].trim()){return decodeURIComponent(cookiePair[1])}}return null}function waitUntil(condFunc){return new Promise((function(resolve,reject){var counter=0;var waitTime=1;function check(){counter++;if(counter==100&&waitTime<1024){waitTime=waitTime*2;counter=0}if(condFunc()){resolve()}else{if(counter<1e3){setTimeout(check,waitTime)}}}check()}))}function pad(number,length){var str=""+number;while(str.length<length){str='0'+str}return str}function generateSlideHtml(appSettings){var s=appSettings.slideSettings;var mainColor=s.mainColor||"#1165f1";var theme=s.theme||"BOTTOM_BTNS";var slide={location:s.location||"TOP_CENTER",showIcon:s.showIcon||false,title:s.showTitle?s.title||'':'',text:s.text||"We'd like to show you notifications for the latest news and updates.",acceptBtnText:s.acceptBtnText||"Allow",cancelBtnText:s.cancelBtnText||"No Thanks",fixed:s.fixed||false};var details={};if(s.advancedOptions){details=fixMissingSlideDetails(s.details,mainColor)}else{details=getDefaultSlideDetails(mainColor)}return"\n<div class=\"dn-slide ".concat(slide.showIcon?'':'dn-slide--noLogo'," ").concat(slide.title?'':'dn-slide--noTitle'," ").concat(theme,"\">\n  <div class=\"dn-slide-logo\"><img src=\"").concat(appSettings.defaultIconUrl,"\"></div>\n  <div class=\"dn-slide-body\">\n      <h3 class=\"dn-slide-title\">").concat(slide.title,"</h3>\n      <p class=\"dn-slide-message\">").concat(slide.text,"</p>\n      <div class=\"dn-slide-buttons horizontal\">\n          <button class=\"dn-slide-deny-btn\">").concat(slide.cancelBtnText,"</button>\n          <button class=\"dn-slide-accept-btn\">").concat(slide.acceptBtnText,"</button>\n      </div>\n  </div>\n  <div class=\"dn-slide-buttons vertical\">\n      <button class=\"dn-slide-accept-btn\">").concat(slide.acceptBtnText,"</button>\n      <button class=\"dn-slide-deny-btn\">").concat(slide.cancelBtnText,"</button>\n  </div>\n</div>\n<style>\n\n  #dengage-push-perm-slide {\n    position: ").concat(slide.fixed?'fixed':'absolute'," !important;\n    width: 520px !important;\n    z-index: 100000000 !important;\n  }\n  #dengage-push-perm-slide.dn-top {\n    top: -260px !important;\n  }\n  #dengage-push-perm-slide.dn-bottom {\n    bottom: -260px !important;\n  }\n  #dengage-push-perm-slide.dn-top.dn-opened {\n    top: 0 !important;\n  }\n  #dengage-push-perm-slide.dn-bottom.dn-opened {\n    bottom: 0 !important;\n  }\n  #dengage-push-perm-slide.dn-center {\n    left: 50% !important;\n    margin-left: -260px !important;\n  }\n  #dengage-push-perm-slide.dn-right {\n    right: 0 !important;\n  }\n  #dengage-push-perm-slide.dn-left {\n    left: 0 !important;\n  }\n  .dn-slide {\n      box-shadow: ").concat(details.shadow?'0 3px 10px 0 rgba(0, 0, 0, 0.43)':'none'," !important;\n      background: ").concat(details.backgroundColor," !important;\n      border: ").concat(details.border,"px solid ").concat(details.borderColor," !important;\n      border-radius: ").concat(details.borderRadius,"px !important;\n      display: flex !important;\n      overflow: auto !important;\n      width: 520px !important;\n      max-width: 520px !important;\n      height: auto !important;\n  }\n\n  .dn-slide-logo {\n      width: 30% !important;\n      padding: 15px !important;\n      box-sizing: border-box !important;\n      display: flex !important;\n      justify-content: center !important;\n      align-items: center !important;\n  }\n  .RIGHT_BTNS .dn-slide-logo {\n      width: 18% !important;\n      padding: 8px !important;\n  }\n  .dn-slide-logo img {\n      width: 100% !important;\n  }\n  .dn-slide--noLogo .dn-slide-logo {\n      display: none !important;\n  }\n\n  .dn-slide-body {\n      width: 70% !important;\n      padding: 15px !important;\n      box-sizing: border-box !important;\n      line-height: 1.4 !important;\n      vertical-align: middle !important;\n      display: flex !important;\n      flex-direction: column !important;\n  }\n  .RIGHT_BTNS .dn-slide-body {\n      width: 58% !important;\n      padding: 8px !important;\n  }\n  .dn-slide--noLogo .dn-slide-body {\n      width: 100% !important;\n  }\n\n  .dn-slide-title {\n      background: none !important;\n      color: ").concat(details.titleSyle.textColor," !important;\n      font-family: ").concat(getFontFamily(details.fontFamily)," !important;\n      font-size: ").concat(details.titleSyle.fontSize,"px !important;\n      font-weight: ").concat(details.titleSyle.fontWeight," !important;\n      margin: 0 !important;\n      padding: 0 !important;\n  }\n  .dn-slide--noTitle .dn-slide-title {\n      display: none !important;\n  }\n\n  .dn-slide-message {\n      background: none !important;\n      color: ").concat(details.textSyle.textColor," !important;\n      font-family: ").concat(getFontFamily(details.fontFamily)," !important;\n      font-size: ").concat(details.textSyle.fontSize,"px !important;\n      font-weight: ").concat(details.textSyle.fontWeight," !important;\n      padding: 0 !important;\n      margin: 12px 0 !important;\n      flex: 1 !important;\n  }\n  .dn-slide--noTitle .dn-slide-message {\n      margin: 5px 0 20px 10px !important;\n  }\n\n  .dn-slide-buttons {\n      display: flex !important;\n  }\n  .dn-slide-buttons.vertical {\n      flex-direction: column !important;\n      justify-content: center !important;\n      align-items: center !important;\n      width: 24% !important;\n      padding: 8px !important;\n  }\n  .dn-slide-buttons.horizontal {\n      justify-content: flex-end !important;\n      align-items: center !important;\n  }\n  .BOTTOM_BTNS .vertical {\n      display: none !important;\n  }\n  .RIGHT_BTNS .horizontal {\n      display: none !important;\n  }\n  .dn-slide-buttons button {\n      padding: 8px 15px !important;\n      margin: 0 !important;\n      text-align: center !important;\n      cursor: pointer !important;\n  }\n  .dn-slide-buttons.horizontal button {\n      margin-left: 15px !important;\n  }\n  .dn-slide-buttons.vertical button {\n      width: 100% !important;\n  }\n  .dn-slide-buttons.vertical button:first-child {\n      margin-bottom: 5px !important;\n  }\n\n  .dn-slide-buttons .dn-slide-accept-btn {\n      background-color: ").concat(details.acceptBtnStyle.backgroundColor," !important;\n      color: ").concat(details.acceptBtnStyle.textColor," !important;\n      font-family: ").concat(getFontFamily(details.fontFamily)," !important;\n      font-size: ").concat(details.acceptBtnStyle.fontSize,"px !important;\n      font-weight: ").concat(details.acceptBtnStyle.fontWeight," !important;\n      border: ").concat(details.acceptBtnStyle.border,"px solid ").concat(details.acceptBtnStyle.borderColor," !important;\n      border-radius: ").concat(details.acceptBtnStyle.borderRadius,"px !important;\n      box-shadow: ").concat(details.acceptBtnStyle.shadow?'0 2px 5px 0 rgba(0, 0, 0, 0.4)':'none'," !important;\n  }\n  .dn-slide-buttons .dn-slide-accept-btn:hover {\n      background-color: ").concat(details.acceptBtnStyle.hoverBackgroundColor," !important;\n      color: ").concat(details.acceptBtnStyle.hoverTextColor," !important;\n  }\n\n  .dn-slide-buttons .dn-slide-deny-btn {\n      background-color: ").concat(details.cancelBtnStyle.backgroundColor," !important;\n      color: ").concat(details.cancelBtnStyle.textColor," !important;\n      font-family: ").concat(getFontFamily(details.fontFamily)," !important;\n      font-size: ").concat(details.cancelBtnStyle.fontSize,"px !important;\n      font-weight: ").concat(details.cancelBtnStyle.fontWeight," !important;\n      border: ").concat(details.cancelBtnStyle.border,"px solid ").concat(details.cancelBtnStyle.borderColor," !important;\n      border-radius: ").concat(details.cancelBtnStyle.borderRadius,"px !important;\n      box-shadow: ").concat(details.cancelBtnStyle.shadow?'0 2px 5px 0 rgba(0, 0, 0, 0.4)':'none'," !important;\n  }\n  .dn-slide-buttons .dn-slide-deny-btn:hover {\n      background-color: ").concat(details.cancelBtnStyle.hoverBackgroundColor," !important;\n      color: ").concat(details.cancelBtnStyle.hoverTextColor," !important;\n  }\n\n  @media only screen and (max-width: 500px) {\n      #dengage-push-perm-slide {\n        width: 100% !important;\n        margin-left: 0 !important;\n        left:0 !important;\n      }\n      #dengage-push-perm-slide.dn-center {\n        left: 0 !important;\n        margin-left: 0 !important;\n      }\n      #dengage-push-perm-slide.dn-right {\n        left: 0 !important;\n        right: 0 !important;\n        margin-left: 0 !important;\n      }\n\n      .dn-slide {\n          width: 100% !important;\n          max-width: 100% !important;\n      }\n\n      /*.dn-slide-title {\n          font-size: 12px !important;\n      }\n\n      .dn-slide-message {\n          font-size: 11px !important;\n      }\n\n      .dn-slide-buttons button {\n          padding: 5px 10px !important;\n          margin-left: 15px !important;\n          font-size: 12px !important;\n      }*/\n  }\n</style>\n    ")}function getDefaultSlideDetails(mainColor){return{backgroundColor:"#ffffff",fontFamily:'ARIAL',border:0,borderColor:mainColor,borderRadius:3,shadow:true,textSyle:{textColor:"#555555",fontSize:"15",fontWeight:"normal"},titleSyle:{textColor:"#555555",fontSize:"16",fontWeight:"bold"},acceptBtnStyle:{backgroundColor:mainColor,hoverBackgroundColor:shadeHexColor(mainColor,-.2),textColor:"#ffffff",hoverTextColor:"#ffffff",fontSize:"16",fontWeight:"normal",border:0,borderColor:mainColor,borderRadius:3,shadow:false},cancelBtnStyle:{backgroundColor:"#ffffff",hoverBackgroundColor:"#ffffff",textColor:mainColor,hoverTextColor:shadeHexColor(mainColor,-.2),fontSize:"16",fontWeight:"normal",border:0,borderColor:mainColor,borderRadius:3,shadow:false}}}function fixMissingSlideDetails(details,mainColor){var textSyle=details.textSyle||{};var titleSyle=details.titleSyle||{};var acceptBtnStyle=details.acceptBtnStyle||{};var cancelBtnStyle=details.cancelBtnStyle||{};return{backgroundColor:details.backgroundColor||"#ffffff",fontFamily:details.fontFamily||'ARIAL',border:details.border||0,borderColor:details.borderColor||mainColor,borderRadius:details.borderRadius||3,shadow:details.shadow==null?true:details.shadow,textSyle:{textColor:textSyle.textColor||"#555555",fontSize:textSyle.fontSize||"15",fontWeight:textSyle.fontWeight||"normal"},titleSyle:{textColor:titleSyle.textColor||"#555555",fontSize:titleSyle.fontSize||"16",fontWeight:titleSyle.fontWeight||"bold"},acceptBtnStyle:{backgroundColor:acceptBtnStyle.backgroundColor||mainColor,hoverBackgroundColor:acceptBtnStyle.hoverBackgroundColor||shadeHexColor(mainColor,-.2),textColor:acceptBtnStyle.textColor||"#ffffff",hoverTextColor:acceptBtnStyle.hoverTextColor||"#ffffff",fontSize:acceptBtnStyle.fontSize||"16",fontWeight:acceptBtnStyle.fontWeight||"normal",border:acceptBtnStyle.border||0,borderColor:acceptBtnStyle.borderColor||mainColor,borderRadius:acceptBtnStyle.borderRadius||3,shadow:acceptBtnStyle.shadow==null?false:acceptBtnStyle.shadow},cancelBtnStyle:{backgroundColor:cancelBtnStyle.backgroundColor||"#ffffff",hoverBackgroundColor:cancelBtnStyle.hoverBackgroundColor||"#ffffff",textColor:cancelBtnStyle.textColor||mainColor,hoverTextColor:cancelBtnStyle.hoverTextColor||shadeHexColor(mainColor,-.2),fontSize:cancelBtnStyle.fontSize||"16",fontWeight:cancelBtnStyle.fontWeight||"normal",border:cancelBtnStyle.border||0,borderColor:cancelBtnStyle.borderColor||mainColor,borderRadius:cancelBtnStyle.borderRadius||3,shadow:cancelBtnStyle.shadow==null?false:cancelBtnStyle.shadow}}}function showSlidePromt(appSettings,isPreview){var container=document.createElement("div");var className="dengage-push-perm-slide";container.id="dengage-push-perm-slide";if(appSettings.slideSettings.location.indexOf('TOP')!=-1){className+=" dn-top"}if(appSettings.slideSettings.location.indexOf('BOTTOM')!=-1){className+=" dn-bottom"}if(appSettings.slideSettings.location.indexOf('CENTER')!=-1){className+=" dn-center"}if(appSettings.slideSettings.location.indexOf('RIGHT')!=-1){className+=" dn-right"}if(appSettings.slideSettings.location.indexOf('LEFT')!=-1){className+=" dn-left"}container.className=className;if(!isPreview){container.style.transition="top 1s linear"}container.innerHTML=generateSlideHtml(appSettings);document.body.appendChild(container);setTimeout((function(){container.className+=" dn-opened"}),50);return{onAccept:function onAccept(callback){var btns=container.querySelectorAll('.dn-slide-accept-btn');for(var i=0;i<btns.length;i++){btns[i].addEventListener("click",(function(){container.classList.remove("dn-opened");callback();setTimeout((function(){document.body.removeChild(container)}),1e3)}))}},onDeny:function onDeny(callback){var btns=container.querySelectorAll('.dn-slide-deny-btn');for(var i=0;i<btns.length;i++){btns[i].addEventListener("click",(function(){container.classList.remove("dn-opened");callback();setTimeout((function(){document.body.removeChild(container)}),1e3)}))}}}}function generateBannerHtml$1(appSettings){var s=appSettings.bannerSettings;var mainColor=s.mainColor||"#333333";var banner={location:s.location||"BOTTOM",showIcon:s.showIcon||false,text:s.text||"We'd like to show you notifications for the latest news and updates.",acceptBtnText:s.acceptBtnText||"Allow",fixed:s.fixed||false};var details={};if(s.advancedOptions){details=fixMissingBannerDetails(s.details,mainColor)}else{details=getDefaultBannerDetails(mainColor)}return"\n<div class=\"dn-banner ".concat(banner.showIcon?'':'dn-banner--noLogo',"\">\n  <div class=\"dn-banner-logo\"><img src=\"").concat(appSettings.defaultIconUrl,"\"></div>\n  <div class=\"dn-banner-text\">\n    ").concat(banner.text,"\n  </div>\n  <div class=\"dn-banner-buttons\">\n      <button class=\"dn-banner-accept-btn\">").concat(banner.acceptBtnText,"</button>\n      <button class=\"dn-banner-deny-btn\">x</button>\n  </div>\n</div>\n<style>\n\n  #dengage-push-perm-banner {\n    position: ").concat(banner.fixed?'fixed':'absolute'," !important;\n    width: 100% !important;\n    z-index: 100000000 !important;\n    left: 0 !important;\n  }\n  #dengage-push-perm-banner.dn-top {\n    top: -200px !important;\n  }\n  #dengage-push-perm-banner.dn-bottom {\n    bottom: -200px !important;\n  }\n  #dengage-push-perm-banner.dn-top.dn-opened {\n    top: 0 !important;\n  }\n  #dengage-push-perm-banner.dn-bottom.dn-opened {\n    bottom: 0 !important;\n  }\n\n  .dn-banner {\n      box-shadow: ").concat(details.shadow?'0 3px 10px 0 rgba(0, 0, 0, 0.43)':'none'," !important;\n      background: ").concat(details.backgroundColor," !important;\n      border-").concat(banner.location=='TOP'?'bottom':'top',": ").concat(details.border,"px solid ").concat(details.borderColor," !important;\n      display: flex !important;\n      overflow: auto !important;\n      width: 100% !important;\n      height: auto !important;\n  }\n\n  .dn-banner-logo {\n      padding: 15px !important;\n      box-sizing: border-box !important;\n      display: flex !important;\n      justify-content: center !important;\n      align-items: center !important;\n  }\n  .dn-banner-logo img {\n      width: 36px !important;\n  }\n  .dn-banner--noLogo .dn-banner-logo {\n      display: none !important;\n  }\n\n  .dn-banner-text {\n      flex: 1 !important;\n      padding: 15px !important;\n      box-sizing: border-box !important;\n      line-height: 1.4 !important;\n      display: flex !important;\n      align-items: center !important;\n      color: ").concat(details.textSyle.textColor," !important;\n      font-family: ").concat(getFontFamily(details.fontFamily)," !important;\n      font-size: ").concat(details.textSyle.fontSize,"px !important;\n      font-weight: ").concat(details.textSyle.fontWeight," !important;\n  }\n  .dn-banner--noLogo .dn-banner-body {\n      width: 100% !important;\n  }\n\n  .dn-banner-buttons {\n      display: flex !important;\n      padding-right: 10px !important;\n      align-items: center !important;\n  }\n  .dn-banner-buttons button {\n      padding: 8px 15px !important;\n      margin: 0 !important;\n      text-align: center !important;\n      cursor: pointer !important;\n  }\n\n  .dn-banner-buttons .dn-banner-accept-btn {\n      background-color: ").concat(details.acceptBtnStyle.backgroundColor," !important;\n      color: ").concat(details.acceptBtnStyle.textColor," !important;\n      font-family: ").concat(getFontFamily(details.fontFamily)," !important;\n      font-size: ").concat(details.acceptBtnStyle.fontSize,"px !important;\n      font-weight: ").concat(details.acceptBtnStyle.fontWeight," !important;\n      border: ").concat(details.acceptBtnStyle.border,"px solid ").concat(details.acceptBtnStyle.borderColor," !important;\n      border-radius: ").concat(details.acceptBtnStyle.borderRadius,"px !important;\n      box-shadow: ").concat(details.acceptBtnStyle.shadow?'0 2px 5px 0 rgba(0, 0, 0, 0.4)':'none'," !important;\n  }\n  .dn-banner-buttons .dn-banner-accept-btn:hover {\n      background-color: ").concat(details.acceptBtnStyle.hoverBackgroundColor," !important;\n      color: ").concat(details.acceptBtnStyle.hoverTextColor," !important;\n  }\n\n  .dn-banner-buttons .dn-banner-deny-btn {\n      background-color: ").concat(details.cancelBtnStyle.backgroundColor," !important;\n      color: ").concat(details.cancelBtnStyle.textColor," !important;\n      font-family: ").concat(getFontFamily(details.fontFamily)," !important;\n      font-size: ").concat(details.cancelBtnStyle.fontSize,"px !important;\n      font-weight: ").concat(details.cancelBtnStyle.fontWeight," !important;\n      border: ").concat(details.cancelBtnStyle.border,"px solid ").concat(details.cancelBtnStyle.borderColor," !important;\n      border-radius: ").concat(details.cancelBtnStyle.borderRadius,"px !important;\n      box-shadow: ").concat(details.cancelBtnStyle.shadow?'0 2px 5px 0 rgba(0, 0, 0, 0.4)':'none'," !important;\n  }\n  .dn-banner-buttons .dn-banner-deny-btn:hover {\n      background-color: ").concat(details.cancelBtnStyle.hoverBackgroundColor," !important;\n      color: ").concat(details.cancelBtnStyle.hoverTextColor," !important;\n  }\n\n  @media only screen and (max-width: 500px) {\n    .dn-banner-logo {\n      display: none !important;\n    }\n    .dn-banner-body {\n      width: 100% !important;\n    }\n    .dn-banner-text {\n      font-size: 14px !important;\n    }\n    .dn-banner-accept-btn {\n      font-size: 15px !important;\n    }\n    .dn-banner-deny-btn {\n      font-size: 15px !important;\n    }\n  }\n</style>\n    ")}function getDefaultBannerDetails(mainColor){return{backgroundColor:'#ffffff',fontFamily:'ARIAL',border:2,borderColor:mainColor,shadow:true,textSyle:{textColor:mainColor,fontSize:'15',fontWeight:'normal'},acceptBtnStyle:{backgroundColor:mainColor,hoverBackgroundColor:shadeHexColor(mainColor,-.2),textColor:'#ffffff',hoverTextColor:'#ffffff',fontSize:'16',fontWeight:'normal',border:0,borderColor:'',borderRadius:0,shadow:false},cancelBtnStyle:{backgroundColor:'#eeeeee',hoverBackgroundColor:'#cccccc',textColor:shadeHexColor(mainColor,.2),hoverTextColor:mainColor,fontSize:'16',fontWeight:'bold',border:0,borderColor:'',shadow:false}}}function fixMissingBannerDetails(details,mainColor){var textSyle=details.textSyle||{};var acceptBtnStyle=details.acceptBtnStyle||{};var cancelBtnStyle=details.cancelBtnStyle||{};return{backgroundColor:details.backgroundColor||"#ffffff",fontFamily:details.fontFamily||'ARIAL',border:details.border||2,borderColor:details.borderColor||mainColor,borderRadius:details.borderRadius||0,shadow:details.shadow==null?true:details.shadow,textSyle:{textColor:textSyle.textColor||"#333333",fontSize:textSyle.fontSize||"15",fontWeight:textSyle.fontWeight||"normal"},acceptBtnStyle:{backgroundColor:acceptBtnStyle.backgroundColor||mainColor,hoverBackgroundColor:acceptBtnStyle.hoverBackgroundColor||shadeHexColor(mainColor,-.2),textColor:acceptBtnStyle.textColor||"#ffffff",hoverTextColor:acceptBtnStyle.hoverTextColor||"#ffffff",fontSize:acceptBtnStyle.fontSize||"16",fontWeight:acceptBtnStyle.fontWeight||"normal",border:acceptBtnStyle.border||0,borderColor:acceptBtnStyle.borderColor||mainColor,borderRadius:acceptBtnStyle.borderRadius||0,shadow:acceptBtnStyle.shadow==null?false:acceptBtnStyle.shadow},cancelBtnStyle:{backgroundColor:cancelBtnStyle.backgroundColor||"#eeeeee",hoverBackgroundColor:cancelBtnStyle.hoverBackgroundColor||"#cccccc",textColor:cancelBtnStyle.textColor||shadeHexColor(mainColor,.2),hoverTextColor:cancelBtnStyle.hoverTextColor||mainColor,fontSize:cancelBtnStyle.fontSize||"16",fontWeight:cancelBtnStyle.fontWeight||"normal",border:cancelBtnStyle.border||0,borderColor:cancelBtnStyle.borderColor||"#eeeeee",shadow:cancelBtnStyle.shadow==null?false:cancelBtnStyle.shadow}}}function showBannerPromt(appSettings,isPreview){var container=document.createElement("div");var className="dengage-push-perm-banner";container.id="dengage-push-perm-banner";if(appSettings.bannerSettings.location.indexOf('TOP')!=-1){className+=" dn-top"}if(appSettings.bannerSettings.location.indexOf('BOTTOM')!=-1){className+=" dn-bottom"}container.className=className;if(!isPreview){container.style.transition="top 1s linear"}container.innerHTML=generateBannerHtml$1(appSettings);document.body.appendChild(container);setTimeout((function(){container.className+=" dn-opened"}),50);return{onAccept:function onAccept(callback){var btn=container.querySelector('.dn-banner-accept-btn');btn.addEventListener("click",(function(){container.classList.remove("dn-opened");callback();setTimeout((function(){document.body.removeChild(container)}),1e3)}))},onDeny:function onDeny(callback){var btn=container.querySelector('.dn-banner-deny-btn');btn.addEventListener("click",(function(){container.classList.remove("dn-opened");callback();setTimeout((function(){document.body.removeChild(container)}),1e3)}))}}}function generateBlockedHtml(appSettings){var s=appSettings.blockedPopup;var slide={title:s.title,titleColor:s.titleColor,message:s.message,showButton:s.showButton,buttonText:s.buttonText,buttonColor:s.buttonColor||'#1165f1'};return"\n      <div id=\"dn-blocked-popup\">\n        <div class=\"dn-blocked-container\">\n            <i class=\"dn-blocked-container-close\">X</i>\n            <img class=\"desktop\" src=\"".concat(isBlinkBrowser()?'https://cdn.dengage.com/internal/chrome.png':'https://cdn.dengage.com/internal/firefox.png',"\" />\n            <img class=\"mobile\" src=\"https://cdn.dengage.com/internal/mobile.png\" />\n            <div class=\"dn-blocked-container-body\">\n                <p class=\"dn-blocked-container-body-title\">\n                  ").concat(slide.title,"\n                </p>\n                <div class=\"dn-blocked-container-body-content\">\n                  ").concat(slide.message,"\n                </div>\n                <div class=\"dn-blocked-container-body-content-button ").concat(slide.showButton?'':'dn-blocked-container-body-content--noLogo',"\">\n                    <button>").concat(slide.buttonText,"</button>\n                </div>\n            </div>\n        </div>\n      </div>\n      <style>\n        #dn-blocked-popup {\n          background: rgba(0,0,0,.4) !important;\n          position: fixed !important;\n          top: 0 !important;\n          left: 0 !important;\n          right: 0 !important;\n          bottom: 0 !important;\n          width: 100% !important;\n          z-index: 100000000 !important;\n        }\n        #dn-blocked-popup .dn-blocked-container {\n          position: absolute !important;\n          left: 130px !important;\n          top: 10px !important;\n        }\n        #dn-blocked-popup .dn-blocked-container img {\n          display: block !important;\n          width: 100% !important;\n        }\n        #dn-blocked-popup .dn-blocked-container img.mobile {\n          display: none !important;\n        }\n        #dn-blocked-popup .dn-blocked-container-close {\n          position: absolute !important;\n          right: 5px !important;\n          cursor: pointer !important;\n          color: #000 !important;\n          font-family: Arial, Helvetica, sans-serif !important;\n          font-style: normal !important;\n          font-size: 12px !important;\n          font-weight: bold !important;\n          line-height: 17px !important;\n        }\n        #dn-blocked-popup .dn-blocked-container-body {\n          background: #fff !important;\n          padding: 15px !important;\n          width: 280px !important;\n        }\n        #dn-blocked-popup .dn-blocked-container-body-title {\n          font-family: Arial, Helvetica, sans-serif !important;\n          font-size: 15px !important;\n          font-weight: bold !important;\n          margin: 0 0 10px 0 !important;\n          color: ").concat(slide.titleColor," !important;\n        }\n        #dn-blocked-popup .dn-blocked-container-body-content {\n          margin-bottom: 15px !important;\n        }\n        #dn-blocked-popup .dn-blocked-container-body-content--noLogo {\n          display: none !important;\n        }\n        #dn-blocked-popup .dn-blocked-container-body-content-button {\n          text-align: right !important;\n        }\n        #dn-blocked-popup .dn-blocked-container-body-content-button button {\n          background: ").concat(slide.buttonColor," !important;\n          color: #fff !important;\n          padding: 8px 15px !important;\n          outline: none !important;\n          cursor: pointer !important;\n          border: none !important;\n          font-family: Arial, Helvetica, sans-serif !important;\n        }\n        @media (max-width:550px) {\n          #dn-blocked-popup .dn-blocked-container {\n            display: flex !important;\n            flex-direction: column !important;\n            justify-content: center !important;\n            align-items: center !important;\n            min-height: 100vh !important;\n            position: static !important;\n            left: auto !important;\n            top: auto !important;\n          }\n          #dn-blocked-popup .dn-blocked-container img {\n            width: 310px !important;\n          }\n          #dn-blocked-popup .dn-blocked-container img.mobile {\n            display: block !important;\n          }\n          #dn-blocked-popup .dn-blocked-container img.desktop {\n            display: none !important;\n          }\n          #dn-blocked-popup .dn-blocked-container-close{\n            display: none !important;\n          }\n        }\n      </style>\n  ")}function showBlockedPromt(appSettings){var container=document.createElement("div");container.id="dn-blocked-popup";container.innerHTML=generateBlockedHtml(appSettings);document.body.appendChild(container);return{onAccept:function onAccept(callback){var btn=container.querySelector('.dn-blocked-container-body-content-button');btn.addEventListener("click",(function(){callback();setTimeout((function(){document.body.removeChild(container)}),50)}))},onClose:function onClose(callback){var btn=container.querySelector('.dn-blocked-container-close');btn.addEventListener("click",(function(){callback();setTimeout((function(){document.body.removeChild(container)}),50)}))}}}function sha256(ascii){function rightRotate(value,amount){return value>>>amount|value<<32-amount}var mathPow=Math.pow;var maxWord=mathPow(2,32);var lengthProperty='length';var i,j;var result='';var words=[];var asciiBitLength=ascii[lengthProperty]*8;var hash=sha256.h=sha256.h||[];var k=sha256.k=sha256.k||[];var primeCounter=k[lengthProperty];var isComposite={};for(var candidate=2;primeCounter<64;candidate++){if(!isComposite[candidate]){for(i=0;i<313;i+=candidate){isComposite[i]=candidate}hash[primeCounter]=mathPow(candidate,.5)*maxWord|0;k[primeCounter++]=mathPow(candidate,1/3)*maxWord|0}}ascii+='';while(ascii[lengthProperty]%64-56){ascii+='\0'}for(i=0;i<ascii[lengthProperty];i++){j=ascii.charCodeAt(i);if(j>>8)return;words[i>>2]|=j<<(3-i)%4*8}words[words[lengthProperty]]=asciiBitLength/maxWord|0;words[words[lengthProperty]]=asciiBitLength;for(j=0;j<words[lengthProperty];){var w=words.slice(j,j+=16);var oldHash=hash;hash=hash.slice(0,8);for(i=0;i<64;i++){var w15=w[i-15],w2=w[i-2];var a=hash[0],e=hash[4];var temp1=hash[7]+(rightRotate(e,6)^rightRotate(e,11)^rightRotate(e,25))+(e&hash[5]^~e&hash[6])+k[i]+(w[i]=i<16?w[i]:w[i-16]+(rightRotate(w15,7)^rightRotate(w15,18)^w15>>>3)+w[i-7]+(rightRotate(w2,17)^rightRotate(w2,19)^w2>>>10)|0);var temp2=(rightRotate(a,2)^rightRotate(a,13)^rightRotate(a,22))+(a&hash[1]^a&hash[2]^hash[1]&hash[2]);hash=[temp1+temp2|0].concat(hash);hash[4]=hash[4]+temp1|0}for(i=0;i<8;i++){hash[i]=hash[i]+oldHash[i]|0}}for(i=0;i<8;i++){for(j=3;j+1;j--){var b=hash[i]>>j*8&255;result+=(b<16?0:'')+b.toString(16)}}return result}var token=null;var webSubscription=null;var params={swUrl:'/dengage-webpush-sw.js',swScope:'/',useSwQueryParams:true};function generateToken(subscription){var subText=JSON.stringify(subscription);subText=subText.replace(/[^ -~]+/g,'');return'dn_'+sha256(subText)}function setSubscriptionValues(subscription){if(!subscription){return}var sub=deepCopy(subscription);if(!sub){return}var subObj={endpoint:sub.endpoint,expirationTime:null,keys:{p256dh:sub.keys.p256dh,auth:sub.keys.auth}};webSubscription=JSON.stringify(subObj);token=generateToken(subObj)}function subscribePush(registration){var options={userVisibleOnly:true,applicationServerKey:'BGApQagqgngiQW4GuhHq5Wk5b8LydEFDg8UMibDBtp2I6xKXVEgOlkYyZhK5YK04M3R9oRA1f_liUj6H6yKxXTQ'};return registration.pushManager.subscribe(options).then((function(newSubscription){setSubscriptionValues(newSubscription)}),errorLoggerRejected('pushManager.subscribe failed'))}function refreshSubscription(registration){return registration.pushManager.getSubscription().then((function(subscription){if(subscription){if(base64Normalize(arrayBufferToBase64(subscription.options.applicationServerKey))==base64Normalize('BGApQagqgngiQW4GuhHq5Wk5b8LydEFDg8UMibDBtp2I6xKXVEgOlkYyZhK5YK04M3R9oRA1f_liUj6H6yKxXTQ')){setSubscriptionValues(subscription)}else{return subscription.unsubscribe().then((function(){return subscribePush(registration)})).catch((function(){logError('subscription.unsubscribe() failed');return subscribePush(registration)}))}}else{return subscribePush(registration)}}),errorLoggerRejected('getSubscription failed'))}var webPushApiClient={detected:function detected(){return'serviceWorker'in navigator&&'PushManager'in window&&'Notification'in window&&typeof Notification.requestPermission=='function'},init:function init(){var currentPermission=Notification.permission;if(currentPermission==='granted'){var serviceWorkerUrl=params.swUrl;if(params.useSwQueryParams){serviceWorkerUrl+='?account_id=265&app_guid=a0503e46-c386-0d14-727f-c0c645e6c08c&domain='+encodeURIComponent(window._Dn_globaL_.domain)}return navigator.serviceWorker.register(serviceWorkerUrl,{scope:params.swScope,updateViaCache:'none'}).then((function(registration){if(params.swScope=='/'){return navigator.serviceWorker.ready.then((function(registration){return refreshSubscription(registration)}),errorLoggerRejected('serviceWorker.ready failed'))}else{return new Promise((function(resolve,reject){setTimeout((function(){resolve(refreshSubscription(registration))}),5e3)}))}}),errorLoggerRejected('An error occurred while registering service worker'))}else{logError('init called when permission is not granted');return Promise.reject()}},getTokenInfo:function getTokenInfo(){var currentPermission=Notification.permission;if(currentPermission==='granted'){if(token==null||webSubscription==null){return navigator.serviceWorker.ready.then((function(registration){return refreshSubscription(registration)})).then((function(){return{token:token,tokenType:'W',webSubscription:webSubscription}}),errorLoggerResolved('serviceWorker.ready failed',null))}return Promise.resolve({token:token,tokenType:'W',webSubscription:webSubscription})}return Promise.resolve(null)},requestPermission:function requestPermission(){return Notification.requestPermission()},getPermission:function getPermission(){return Notification.permission},setParams:function setParams(p){objectAssign(params,p)}};var appSettings=JSON.parse('{  "siteUrl": "https://www.marham.pk",  "autoShow": true,  "bellSettings": {    "size": "MEDIUM",    "location": "RIGHT",    "mainColor": "#1165f1",    "leftOffset": 0,    "accentColor": "#333333",    "dialogTitle": "",    "rightOffset": 0,    "bottomOffset": 0,    "advancedOptions": false,    "unsubscribeText": "",    "hideIfSubscribed": false,    "subscribeBtnText": "",    "unblockGuideText": "",    "subscribedTooltip": "",    "unsubscribeBtnText": "",    "nonSubscriberTooltip": "",    "afterSubscriptionText": "",    "unblockNotificationText": "",    "blockedSubscriberTooltip": ""  },  "blockedPopup": {    "delay": 5,    "title": "You have blocked the notifications",    "enabled": false,    "message": "<p>Please allow the notifications by clicking the icon&nbsp; above.</p>",    "buttonText": "",    "showButton": false,    "titleColor": "#014E78",    "buttonColor": "#1165f1",    "maxShowCount": 5,    "repromptAfterXHours": 24  },  "slideSettings": {    "text": "Marham would like to show you notifications for the latest news and updates.",    "fixed": false,    "theme": "BOTTOM_BTNS",    "title": "",    "details": null,    "location": "TOP_CENTER",    "showIcon": true,    "mainColor": "#014E78",    "showTitle": false,    "acceptBtnText": "Allow",    "cancelBtnText": "No Thanks",    "advancedOptions": false  },  "allowedDomains": [],  "bannerSettings": {    "text": "",    "fixed": true,    "theme": "DEFAULT",    "details": null,    "location": "BOTTOM",    "showIcon": true,    "mainColor": "#333333",    "acceptBtnText": "Enable",    "advancedOptions": false  },  "defaultIconUrl": "https://cdn.dengage.com/42ad9511-71f0-0171-6c66-6b5bf6c6c944/favorites/marhampklogo.jpg",  "selectedPrompt": "SLIDE",  "autoShowSettings": {    "delay": 5,    "denyWaitTime": 0,    "promptAfterXVisits": 0,    "repromptAfterXMinutes": 12  },  "subdomainDataSync": false,  "welcomeNotification": {    "link": "",    "title": "",    "enabled": false,    "message": ""  },  "triggerNavigationOnLoad": false}');appSettings.allowedDomains=appSettings.allowedDomains||[];appSettings.allowedDomains.push(appSettings.siteUrl);appSettings.allowedDomains=appSettings.allowedDomains.map((function(d){var u=new URL(d);return u.host}));function checkPush(showError){var pushEnabled=false;try{pushEnabled=JSON.parse('true')}catch(e){}if(pushEnabled==false&&showError===true){logError('Web push is not enabled for this site on dengage platform');return false}return pushEnabled}function checkOnSite(showError){var onsiteEnabled=false;try{onsiteEnabled=JSON.parse('false')}catch(e){}if(onsiteEnabled==false&&showError===true){logError('onsite popups are not enabled for this site on dengage platform');return false}return onsiteEnabled}function isPushEnabled(){if(appSettings.subdomainDataSync){var webpushDomain=window._Dn_globaL_.cookieData.webpushDomain;if(webpushDomain&&webpushDomain!=location.host){return false}}return pushClient.detected()&&checkPush(false)}function isEventsEnabled(){var enabled=true;try{enabled=JSON.parse('true')}catch(e){}return enabled}var endpoints=["https://fcm.googleapis.com/fcm/send/","https://updates.push.services.mozilla.com/wpush/v2/","https://bn3p.notify.windows.com/w/?token=","https://wns2-by3p.notify.windows.com/w/?token=","https://wns2-db5p.notify.windows.com/w/?token=","https://wns2-sg2p.notify.windows.com/w/?token=","https://dm3p.notify.windows.com/w/?token=","https://bn2-ppe.notify.windows.com/w/?token=","https://wns2-bl2p.notify.windows.com/w/?token=","https://par02p.notify.windows.com/w/?token=","https://sg2p.notify.windows.com/w/?token=","https://am3p.notify.windows.com/w/?token="];function encodeCookieData(cookieData){var tokenType=getTokenType$1(cookieData);var _token=getToken$1(cookieData,tokenType);var cookieStr=escapePipe(cookieData.deviceId)+'|'+tokenType+'|'+_token+'|'+escapePipe(cookieData.contactKey)+'|'+escapePipe(cookieData.webpushDomain);return cookieStr}function parseCookieData(cookieStr){if(!cookieStr){return null}cookieStr=cookieStr.replace(/\%\|/g,'##DN_PIPE_A6H8VBC##');var parts=cookieStr.split('|');for(var i=0;i<parts.length;i++){parts[i]=parts[i].replace(/##DN_PIPE_A6H8VBC##/g,'|')}var tokenType=parts[1]=='S'||parts[1]=='F'||parts[1]==''?parts[1]:'W',token=parts[2],webSubscription=null;if(tokenType=='W'){var urlPrefix=parts[1]=='W'?'':endpoints[parseInt(parts[1])-1];webSubscription={endpoint:urlPrefix+parts[2],expirationTime:null,keys:{p256dh:parts[3],auth:parts[4]}};token=generateToken(webSubscription)}if(parts.length==7){var cookieData={deviceId:parts[0],tokenType:tokenType,token:token,webSubscription:JSON.stringify(webSubscription),contactKey:parts[5],webpushDomain:parts[6]};return cookieData}else{logError('cookie should be 7 parts');return null}}function getTokenType$1(cookieData){if(cookieData.tokenType=='S'||cookieData.tokenType=='F'){return cookieData.tokenType}if(cookieData.token&&cookieData.webSubscription){var webSubscription=JSON.parse(cookieData.webSubscription);var ep=endpoints.find((function(e){return webSubscription.endpoint.startsWith(e)}));if(ep){return endpoints.indexOf(ep)+1+''}return'W'}return''}function getToken$1(cookieData,tokenType){if(!cookieData.token||!tokenType){return'||'}if(tokenType=='S'||tokenType=='F'){return escapePipe(cookieData.token)+'||'}var webSubscription=JSON.parse(cookieData.webSubscription);var endpoint=webSubscription.endpoint;if(tokenType!='W'){var index=parseInt(tokenType)-1;endpoint=endpoint.replace(endpoints[index],'')}return escapePipe(endpoint)+'|'+escapePipe(webSubscription.keys.p256dh)+'|'+escapePipe(webSubscription.keys.auth)}function escapePipe(str){str=str||'';return str.replace(/\|/g,'%|')}var storedSessionId=storage.sessionGet('dengage_session_id')||getCookie('_dn_sid');if(storage.sessionGet('dengage_new_device')=='true'||normalizeLong$1(storage.get('dengage_device_id')==null)){storedSessionId=null;storage.sessionSet('dengage_new_device','false')}var sessionId=storedSessionId||generateUUID();storage.sessionSet('dengage_session_id',sessionId);var now=new Date;now.setTime(now.getTime()+30*60*1e3);var parentDomain=findParentDomain(appSettings.allowedDomains)||'';if(parentDomain.length<5||location.host.indexOf(parentDomain)<0){parentDomain=location.host}document.cookie="_dn_sid="+sessionId+"; path=/; domain=."+parentDomain+"; expires="+now.toUTCString()+";";function isNewSession(){return!storedSessionId}function getSessionId(){return sessionId}function normalizeLong$1(val){if(!val||typeof val=='string'&&val.length<10){return null}return val}var isSubscriptionSent=!isNewSession();var isStarted=false;var triggerAfterStart=false;var aboutToSend=false;function triggerSend(){if(isStarted==false){triggerAfterStart=true;return}if(aboutToSend==false){aboutToSend=true;setTimeout((function(){aboutToSend=false;saveSubscriptionCookie();sendSubscription()}),1e3)}}function start$2(){if(getToken()==null&&isEventsEnabled()==false&&checkOnSite()==false){return}isStarted=true;if(triggerAfterStart){triggerSend()}else{setTimeout((function(){if(isSubscriptionSent==false){triggerSend()}}),1e3)}}function setDeviceId(value){var deviceId=normalizeLong(value);if(deviceId&&getDeviceId()!=deviceId){storage.set('dengage_device_id',deviceId);triggerSend()}}function getDeviceId(){var deviceId=normalizeLong(storage.get('dengage_device_id'));if(!deviceId){deviceId=deviceId||generateUUID();storage.sessionSet('dengage_new_device','true');storage.set('dengage_device_id',deviceId);triggerSend()}return deviceId}function getContactKey(){var val=storage.get('dengage_contact_key');return normalizeShort(val)}function setContactKey(value){if(getContactKey()!=normalizeShort(value)){storage.set('dengage_contact_key',normalizeShort(value)||'');triggerSend()}}function getToken(){var val=storage.get('dengage_webpush_token');return normalizeLong(val)}function setToken(value){if(getToken()!=normalizeLong(value)){storage.set('dengage_webpush_token',normalizeLong(value)||'');triggerSend();if(isStarted==false){start$2()}}}function getTokenType(){var val=storage.get('dengage_webpush_token_type');return normalizeShort(val)}function setTokenType(value){if(getTokenType()!=normalizeShort(value)){storage.set('dengage_webpush_token_type',normalizeShort(value)||'');triggerSend()}}function getWebSubscription(){var val=storage.get('dengage_webpush_sub');return normalizeLong(val)}function setWebSubscription(value){if(getWebSubscription()!=normalizeLong(value)){storage.set('dengage_webpush_sub',normalizeLong(value)||'');triggerSend()}}function getUserPermission(){var val=storage.get('dengage_user_permission');return normalizeShort(val)}function setUserPermission(value){if(getUserPermission()!=normalizeShort(value)){storage.set('dengage_user_permission',normalizeShort(value)||'');triggerSend()}}function getCountry(){var val=storage.get('dengage_country');return normalizeShort(val)}function setCountry(value){if(getCountry()!=normalizeShort(value)){storage.set('dengage_country',normalizeShort(value)||'');triggerSend()}}function sendSubscription(){isSubscriptionSent=true;var userPermission=getUserPermission();var deviceId=getDeviceId();var data={integrationKey:'kZpOJVUthZI4augANOBui4H4XDAzKR_s_l__s_l_W6sUsZ3kK_s_l_eyTFIxcM7nVz7lEEQglHPesArrvK_s_l_NRyls07uak85bt43XgB7v6pw81O2A3JfnnJFMLNJotBX6B14x9vi14jol',token:getToken(),contactKey:getContactKey(),permission:userPermission==null||userPermission=='true'?true:false,udid:deviceId,advertisingId:'',carrierId:null,appVersion:null,sdkVersion:'1.0',trackingPermission:true,webSubscription:getWebSubscription(),tokenType:getTokenType(),timezone:getTimezone(),language:navigator.language||navigator.userLanguage,country:getCountry()};fetch('https://push.dengage.com/api/web/subscription',{method:'POST',mode:'cors',cache:'no-cache',credentials:'omit',headers:{'Content-Type':'text/plain'},body:JSON.stringify(data)}).catch((function(e){logError(e.toString())}))}function saveSubscriptionCookie(){if(appSettings.subdomainDataSync){var cookieData={deviceId:getDeviceId(),tokenType:getTokenType(),token:getToken(),webSubscription:getWebSubscription(),contactKey:getContactKey(),webpushDomain:_Dn_globaL_.cookieData.webpushDomain};var cookieStr=encodeCookieData(cookieData);document.cookie="_dn_data="+cookieStr+"; path=/; domain=."+findParentDomain(appSettings.allowedDomains);_Dn_globaL_.cookieData=cookieData}}function normalizeShort(val){if(!val||val==='null'){return null}return val}function normalizeLong(val){if(!val||typeof val=='string'&&val.length<10){return null}return val}function getTimezone(){var offset=(new Date).getTimezoneOffset();return'GMT'+(offset<0?'+':'-')+pad(parseInt(Math.abs(offset/60)),2)+':'+pad(Math.abs(offset%60),2)}var permissionData=null;function getWebsitePushID(){var host=new URL(appSettings.siteUrl);var webSiteID=host.hostname.split('.').concat('web').reverse().join('.');return webSiteID}function refreshPermissionData(){permissionData=window.safari.pushNotification.permission(getWebsitePushID())}var safariClient={detected:function detected(){var safariEnabled=false;try{safariEnabled=JSON.parse('false')}catch(e){}return'safari'in window&&_typeof(window.safari)=='object'&&'pushNotification'in window.safari&&safariEnabled},init:function init(){if(permissionData==null){refreshPermissionData()}if(permissionData.permission=='granted'){return Promise.resolve()}else{logError('init called when permission is not granted');return Promise.reject()}},getTokenInfo:function getTokenInfo(){if(permissionData==null){refreshPermissionData()}if(permissionData.permission==='granted'){return Promise.resolve({token:permissionData.deviceToken,tokenType:'S',webSubscription:null})}return Promise.resolve(null)},requestPermission:function requestPermission(){return new Promise((function(resolve,reject){if(permissionData==null){refreshPermissionData()}function safariPermissionCb(result){permissionData=result;if(permissionData.permission==='default'){logError('User made default. it is impossible')}else if(permissionData.permission==='denied'){logInfo('User said no')}else if(permissionData.permission==='granted'){logInfo('user said yes');logInfo('Token: '+permissionData.deviceToken)}resolve(permissionData.permission)}if(permissionData.permission=='default'){var deviceId=getDeviceId();var websitePushID=getWebsitePushID();var url='https://push.dengage.com/api/safari/42ad9511-71f0-0171-6c66-6b5bf6c6c944';var userInfo={device_id:deviceId};window.safari.pushNotification.requestPermission(url,websitePushID,userInfo,safariPermissionCb)}else{logError('requestPermission called when permission is not default');reject()}}))},getPermission:function getPermission(){if(permissionData==null){refreshPermissionData()}return permissionData.permission},setParams:function setParams(){}};var pushClient={detected:function detected(){return false}};if(safariClient.detected()){objectAssign(pushClient,safariClient)}else{objectAssign(pushClient,webPushApiClient)}function showNativePrompt$1(grantedCallback,deniedCallback){pushClient.requestPermission().then((function(permission){if(permission==='granted'){setLocalStoragePromptResult('granted');if(grantedCallback){grantedCallback()}}else{setLocalStoragePromptResult('denied');if(deniedCallback){deniedCallback()}}}))}function showCustomPrompt$1(grantedCallback,deniedCallback){if(appSettings.selectedPrompt=='SLIDE'){var slidePrompt=showSlidePromt(appSettings);slidePrompt.onAccept((function(){showNativePrompt$1(grantedCallback,deniedCallback)}));slidePrompt.onDeny((function(){setLocalStoragePromptResult('denied');if(deniedCallback){deniedCallback()}}))}else if(appSettings.selectedPrompt=='BANNER'){var bannerPrompt=showBannerPromt(appSettings);bannerPrompt.onAccept((function(){showNativePrompt$1(grantedCallback,deniedCallback)}));bannerPrompt.onDeny((function(){setLocalStoragePromptResult('denied');if(deniedCallback){deniedCallback()}}))}else{showNativePrompt$1(grantedCallback,deniedCallback)}localStorage.setItem('dengage_webpush_last_a','ask');localStorage.setItem('dengage_webpush_last_d',(new Date).valueOf()+'')}function startAutoPrompt(grantedCallback,deniedCallback){var autoShowSettings=appSettings.autoShowSettings;var sessionStartTime=getSessionStartTime();var now=new Date;var setPrompt=function setPrompt(){var delay=toInt(autoShowSettings.delay||1)*1e3;var passedTime=now.valueOf()-sessionStartTime.valueOf();var waitTime=delay-passedTime;waitTime=waitTime>0?waitTime:0;setTimeout((function(){showCustomPrompt$1(grantedCallback,deniedCallback)}),waitTime)};var visitCount=toInt(localStorage.getItem('dengage_visit_count'));localStorage.setItem('dengage_visit_count',visitCount+1);if(toInt(autoShowSettings.promptAfterXVisits)<=visitCount){var lastPromptAction=localStorage.getItem('dengage_webpush_last_a')||'';var lastPromptDate=toInt(localStorage.getItem('dengage_webpush_last_d'));lastPromptDate=new Date(lastPromptDate);var denyWaitTime=toInt(autoShowSettings.denyWaitTime||24)*60*60*1e3;var denyWaitUntil=new Date(lastPromptDate.valueOf()+denyWaitTime);var repromptWaitTime=toInt(autoShowSettings.repromptAfterXMinutes)*60*60*1e3;var repromptWaitUntil=new Date(lastPromptDate.valueOf()+repromptWaitTime);if(lastPromptAction=='denied'){if(now>=denyWaitUntil){setPrompt()}}else{if(now>=repromptWaitUntil){setPrompt()}}}}function startBlockedPrompt(){var blockedSettings=appSettings.blockedPopup;var sessionStartTime=getSessionStartTime();var now=new Date;var setPrompt=function setPrompt(){var delay=toInt(blockedSettings.delay||1)*1e3;var passedTime=now.valueOf()-sessionStartTime.valueOf();var waitTime=delay-passedTime;waitTime=waitTime>0?waitTime:0;setTimeout((function(){localStorage.setItem('dengage_push_blocked_count',blockedPromptCount+1);localStorage.setItem('dengage_push_blocked_last_d',now.valueOf());var blockedPrompt=showBlockedPromt(appSettings);blockedPrompt.onAccept((function(){}));blockedPrompt.onClose((function(){}))}),waitTime)};var blockedPromptCount=toInt(localStorage.getItem('dengage_push_blocked_count'));if(toInt(blockedSettings.maxShowCount)>blockedPromptCount){var lastPromptDate=toInt(localStorage.getItem('dengage_push_blocked_last_d'));lastPromptDate=new Date(lastPromptDate);var waitTime=toInt(blockedSettings.repromptAfterXHours||48)*60*60*1e3;var waitUntil=new Date(lastPromptDate.valueOf()+waitTime);if(now>=waitUntil){setPrompt()}}}function getSessionStartTime(){var val=toInt(sessionStorage.getItem('dengage_session_start'));if(val){val=new Date(val)}else{val=new Date;sessionStorage.setItem('dengage_session_start',val.valueOf()+'')}return val}function toInt(input){if(typeof input=='number'){return input}if(typeof input=='string'){return input===''?0:parseInt(input)}return 0}function setLocalStoragePromptResult(result){localStorage.setItem('dengage_webpush_last_a',result);localStorage.setItem('dengage_webpush_last_d',(new Date).valueOf()+'')}var permissionPromptManager=Object.freeze({__proto__:null,showNativePrompt:showNativePrompt$1,showCustomPrompt:showCustomPrompt$1,startAutoPrompt:startAutoPrompt,startBlockedPrompt:startBlockedPrompt});function showNotificationSimple(data){var title=data.title;var iconUrl=data.iconUrl=='default_icon'?appSettings.defaultIconUrl:(data.iconUrl||'').trim();var options={body:data.message,requireInteraction:true};if(data.mediaUrl){options.image=data.mediaUrl}if(iconUrl){options.icon=iconUrl}if(data.badgeUrl){options.badge=data.badgeUrl}var notif=new Notification(title,options);if(data.targetUrl){notif.onclick=function(event){if(event.notification){event.notification.close()}window.open(data.targetUrl);if(data.messageId!=null&&data.messageDetails!=null){sendOpen(data.messageId,data.messageDetails)}}}}function sendOpen(messageId,messageDetails,buttonId){var data={integrationKey:"kZpOJVUthZI4augANOBui4H4XDAzKR_s_l__s_l_W6sUsZ3kK_s_l_eyTFIxcM7nVz7lEEQglHPesArrvK_s_l_NRyls07uak85bt43XgB7v6pw81O2A3JfnnJFMLNJotBX6B14x9vi14jol",messageId:messageId,messageDetails:messageDetails,buttonId:buttonId||''};return fetch('https://push.dengage.com/api/web/open',{method:'POST',mode:'cors',cache:'no-cache',credentials:'omit',headers:{'Content-Type':'text/plain'},body:JSON.stringify(data)}).catch((function(e){logError(e.toString())}))}function startPushClient(callback,isFirstTime){pushClient.init().then((function(){pushClient.getTokenInfo().then((function(tokenInfo){logInfo('Token: '+tokenInfo.token);setToken(tokenInfo.token);setTokenType(tokenInfo.tokenType);setWebSubscription(tokenInfo.webSubscription||null);_Dn_globaL_.cookieData.webpushDomain=location.host;if(isFirstTime){showWellcomeNotification()}callback()})).catch((function(err){logError('pushClient.getTokenInfo() failed. ',err);callback()}))})).catch((function(err){logError('pushClient.init() failed. ',err);callback()}))}function start$1(callback){callback=callback||function(){};var currentPermission=pushClient.getPermission();if(currentPermission=='granted'){logInfo('Notification permission already granted.');startPushClient(callback)}else if(currentPermission=='default'){setToken(null);setTokenType(null);setWebSubscription(null);_Dn_globaL_.cookieData.webpushDomain='';if(appSettings.autoShow){var onPermissionGranted=function onPermissionGranted(){logInfo('Notification permission granted.');startPushClient(callback,true)};var onPermissionDenied=function onPermissionDenied(){logInfo('Notification permission denied.')};startAutoPrompt(onPermissionGranted,onPermissionDenied)}callback()}else{if(appSettings.blockedPopup&&appSettings.blockedPopup.enabled&&(isBlinkBrowser()||isFirefoxBrowser())){startBlockedPrompt()}logInfo('Notification permission denied');setToken(null);setTokenType(null);setWebSubscription(null);_Dn_globaL_.cookieData.webpushDomain='';callback()}}function showNativePrompt(){return showPrompt('showNativePrompt')}function showCustomPrompt(){return showPrompt('showCustomPrompt')}function showPrompt(functionName){return new Promise((function(resolve,reject){var permission=pushClient.getPermission();if(permission=='default'){permissionPromptManager[functionName]((function(){startPushClient((function(){}),true);resolve('granted')}),(function(){resolve('denied')}))}else{resolve(permission)}}))}function showWellcomeNotification(){if(appSettings.welcomeNotification.enabled){setTimeout((function(){var data={title:appSettings.welcomeNotification.title,message:appSettings.welcomeNotification.message,targetUrl:appSettings.welcomeNotification.link};showNotificationSimple(data)}),500)}}function sendEvent(table,key,data){if(getSessionId()&&isEventsEnabled()){var params={accountId:'42ad9511-71f0-0171-6c66-6b5bf6c6c944',key:key,eventTable:table,eventDetails:data};logInfo(params);return fetch('https://event.dengage.com/api/web/event',{method:'POST',mode:'cors',cache:'no-cache',credentials:'omit',headers:{'Content-Type':'text/plain'},body:JSON.stringify(params)}).catch((function(e){logError(e.toString())}))}}function sendDeviceEvent(table,data){var deviceId=getDeviceId();data.session_id=getSessionId();return sendEvent(table,deviceId,data)}function sendCustomEvent(table,key,data){return sendEvent(table,key,data)}var list=[' Daum/',' DeuSu/',' MuckRack/',' Sysomos/',' um-LN/','!Susie','/www\\.answerbus\\.com','/www\\.unchaos\\.com','/www\\.wmtips\\.com','008/','192\\.comAgent','8484 Boston Project','<http://www\\.sygol\\.com/>','\\(privoxy/','^AHC/','^Amazon CloudFront','^axios/','^Disqus/','^Friendica','^Hatena','^http_get','^Jetty/','^MeltwaterNews','^MixnodeCache/','^newspaper/','^NextCloud-News/','^ng/','^NING','^Nuzzel','^okhttp','^sentry/','^Thinklab','^Tiny Tiny RSS/','^Traackr.com','^Upflow/','^Zabbix','Abonti','Aboundex','aboutthedomain','ac{1,2}oon','Ad Muncher','adbeat\\.com','AddThis','ADmantX','agada.de','agadine/','aggregator','aiderss/','airmail\\.etn','airmail\\net','aladin/','alexa site audit','allrati/','AltaVista Intranet','alyze\\.info','amzn_assoc','analyza','analyzer','Anemone','Anturis Agent','AnyEvent-HTTP','Apache-HttpClient','APIs-Google','Aport','AppEngine-Google','appie','AppInsights','Arachmo','arachnode\\.net','Arachnoidea','Arachnophilia/','araneo/','archive','archiving','asafaweb\\.com','asahina-antenna/','ask[-\\s]?jeeves','ask\\.24x\\.info','aspseek/','AspTear','assort/','asterias/','atomic_email_hunter/','atomz/','augurfind','augurnfind','auto','Avirt Gateway Server','Azureus','B-l-i-t-z-B-O-T','B_l_i_t_z_B_O_T','BackStreet Browser','BCKLINKS 1\\.0','beammachine/','beebwaredirectory/v0\\.01','bibnum\\.bnf','Big Brother','Big Fish','BigBozz/','bigbrother/','biglotron','bilbo/','BilderSauger','BingPreview','binlar','Blackboard Safeassign','BlackWidow','blaiz-bee/','bloglines/','Blogpulse','blogzice/','BMLAUNCHER','bobby/','boitho\\.com-dc','bookdog/x\\.x','Bookmark Buddy','Bookmark Renewal','bookmarkbase\\(2/;http://bookmarkbase\\.com\\)','BorderManager','bot','BrandVerity/','BravoBrian','Browsershots','bsdseek/','btwebclient/','BUbiNG','BullsEye','bumblebee@relevare\\.com','BunnySlippers','Buscaplus','butterfly','BW-C-2','bwh3_user_agent','calif/','capture','carleson/','CC Metadata Scaper','ccubee/x\\.x','CE-Preload','Ceramic Tile Installation Guide','Cerberian Drtrs','CERN-HTTPD','cg-eye interactive','changedetection','Charlotte','charon/','Chat Catcher/','check','China Local Browse','Chitika ContentHit','Chrome-Lighthouse','CJB\\.NET Proxy','classify','Claymont\\.com','cloakdetect/','CloudFlare-AlwaysOnline','clown','cnet\\.com','COAST WebMaster Pro/','CoBITSProbe','coccoc','cocoal\\.icio\\.us/','ColdFusion','collage\\.cgi/','collect','combine/','Commons-HttpClient','ContentSmartz','contenttabreceiver','control','convera','copperegg/revealuptime/fremontca','coralwebprx/','cosmos','Covac UPPS Cathan','Covario-IDS','crawl','crowsnest/','csci_b659/','Custo x\\.x \\(www\\.netwu\\.com\\)','cuwhois/','CyberPatrol','DA \\d','DAP x','DareBoost','datacha0s/','datafountains/dmoz','Datanyze','dataprovider','DAUMOA-video','dbdig\\(http://www\\.prairielandconsulting\\.com\\)','DBrowse \\d','dc-sakura/x\\.xx','DDD','deep[-\\s]?link','deepak-usc/isi','delegate/','DepSpid','detector','developers\\.google\\.com\\/\\+\\/web\\/snippet\\/','diagem/','diamond/x\\.0','Digg','DigOut4U','DISCo Pump x\\.x','dlman','dlvr\\.it/','DnloadMage','docomo/','DomainAppender','Download Demon','Download Druid','Download Express','Download Master','Download Ninja','Download Wonder','download(?:s|er)','Download\\.exe','DownloadDirect','DreamPassport','drupact','Drupal','DSurf15','DTAAgent','DTS Agent','Dual Proxy','e-sense','EARTHCOM','easydl/','EBrowse \\d','ecairn\\.com/grabber','echo!/','efp@gmx\\.net','egothor/','ejupiter\\.com','EldoS TimelyWeb/','ElectricMonk','EmailWolf','Embedly','envolk','ESurf15','evaliant','eventax/','Evliya Celebi','exactseek\\.com','Exalead','Expired Domain Sleuth','Exploratodo/','extract','EyeCatcher','eyes','ezooms','facebookexternalhit','faedit/','FairAd Client','fantom','FastBug','Faveeo/','FavIconizer','FavOrg','FDM \\d','feed','feeltiptop\\.com','fetch','fileboost\\.net/','filtrbox/','FindAnISP\\.com','finder','findlink','findthatfile','firefly/','FlashGet','FLATARTS_FAVICO','flexum/','FlipboardProxy/','FlipboardRSS/','fluffy','flunky','focusedsampler/','FollowSite','forensiq\\.com','francis/','freshdownload/x\\.xx','FSurf','FuseBulb\\.Com','g00g1e\\.net','galaxy\\.com','gather','gazz/x\\.x','geek-tools\\.org','genieknows','Genieo','getright(pro)?/','getter','ghostroutehunter/','gigabaz/','GigablastOpenSource','go!zilla','go-ahead-got-it/','Go-http-client','GoBeez','goblin/','GoForIt\\.com','Goldfire Server','gonzo[1-2]','gooblog/','goofer/','Google Favicon','Google Page Speed Insights','Google Web Preview','Google Wireless Transcoder','Google-PhysicalWeb','Google-Site-Verification','Google-Structured-Data-Testing-Tool','google-xrawler','GoogleImageProxy','gopher','gossamer-threads\\.com','grapefx/','gromit/','GroupHigh/','grub-client','GTmetrix','gulliver/','H010818','hack','harvest','haste/','HeadlessChrome/','helix/','heritrix','HiDownload','hippias/','HitList','Holmes','hotmail.com','hound','htdig','html2','http-header-abfrage/','http://anonymouse\\.org/','http://ask\\.24x\\.info/','http://www\\.ip2location\\.com','http://www\\.monogol\\.de','http://www\\.sygol\\.com','http://www\\.timelyweb\\.com/','http::lite/','http_client','HTTPGet','HTTPResume','httpunit','httrack','HubSpot Marketing Grader','hyperestraier/','HyperixScoop','ichiro','ics \\d','IDA','ideare - SignSite','idwhois\\.info','IEFav172Free','iframely/','IlTrovatore-Setaccio','imageengine/','images','imagewalker/','InAGist','incywincy\\(http://www\\.look\\.com\\)','index','info@pubblisito\\.com','infofly/','infolink/','infomine/','InfoSeek Sidewinder/','InfoWizards Reciprocal Link System PRO','inkpeek\\.com','Insitornaut','inspectorwww/','InstallShield DigitalWizard','integrity/','integromedb','intelix/','intelliseek\\.com','Internet Ninja','internetlinkagent/','InterseekWeb','IODC','IOI','ips-agent','iqdb/','iria/','irvine/','isitup\\.org','isurf','ivia/','iwagent/','j-phone/','Jack','java/','JBH Agent 2\\.0','JemmaTheTourist','JetCar','jigsaw/','jorgee','Journster','kalooga/kalooga-4\\.0-dev-datahouse','Kapere','kasparek@naparek\\.cz','KDDI-SN22','ke_1\\.0/','Kevin','KimonoLabs','kit-fireball/','KnowItAll','knowledge\\.com/','Kontiki Client','kulturarw3/','kummhttp/','L\\.webis','labrador/','Lachesis','Larbin','leech','leia/','LibertyW','library','libweb/clshttp','lightningdownload/','Lincoln State Web Browser','Link Commander','Link Valet','linkalarm/','linkdex','LinkExaminer','Linkguard','linkman','LinkPimpin','LinkProver','Links2Go','linksonar/','LinkStash','LinkTiger','LinkWalker','Lipperhey Link Explorer','Lipperhey SEO Service','Lipperhey Site Explorer','Lipperhey-Kaus-Australis/','loader','loadimpactrload/','locate','locator','Look\\.com','Lovel','ltx71','lwp-','lwp::','mabontland','mack','magicwml/','mail\\.ru/','mammoth/','MantraAgent','MapoftheInternet\\.com','Marketwave Hit List','Martini','Marvin','masagool/','MasterSeek','Mastodon/','Mata Hari/','mediaget','Mediapartners-Google','MegaSheep','Megite','Mercator','metainspector/','metaspinner/','metatagsdir/','MetaURI','MicroBaz','Microsoft_Internet_Explorer_5','miixpc/','Mindjet MindManager','Miniflux/','miniflux\\.net','Missouri College Browse','Mister Pix','Mizzu Labs','Mo College','moget/x\\.x','mogimogi','moiNAG','monitor','monkeyagent','MonTools\\.com','Morning Paper','Mrcgiguy','MSIE or Firefox mutant','msnptc/','msproxy/','Mulder','multiBlocker browser','multitext/','MuscatFerret','MusicWalker2','MVAClient','naofavicon4ie/','naparek\\.cz','netants/','Netcraft Web Server Survey','NetcraftSurveyAgent/','netlookout/','netluchs/','NetMechanic','netpumper/x\\.xx','NetSprint','netwu\\.com','neutrinoapi/','NewsGator','newt','nico/','Nmap Scripting Engine','NORAD National Defence Network','Norton-Safeweb','Notifixious','noyona_0_1','nsauditor/','nutch','Nymesis','ocelli/','Octopus','Octora Beta','ODP links','oegp','OliverPerry','omgili','Onet\\.pl','Oracle Application','Orbiter','OSSProxy','outbrain','ow\\.ly','ownCloud News/','ozelot/','Page Valet/','page2rss','Pagebull','PagmIEDownload','Panopta v','panscient','parasite/','parse','pavuk/','PayPal IPN','PBrowse','Pcore-HTTP','pd02_1','Peew','perl','Perman Surfer','PEval','phantom','photon/','php/\\d','Pingdom','Pingoscope','pingspot/','pinterest\\.com','Pita','Pizilla','Ploetz \\+ Zeller','Plukkie','pockey-gethtml/','pockey/x\\.x\\.x','Pockey7','Pogodak','Poirot','Pompos','popdexter/','Port Huron Labs','PostFavorites','PostPost','postrank','Powermarks','PR-CY.RU','pricepi\\.com','prlog\\.ru','pro-sitemaps\\.com','program','Project XP5','protopage/','proximic','PSurf15a','psycheclone','puf/','PureSight','PuxaRapido','python','Qango\\.com Web Directory','QuepasaCreep','Qwantify','QXW03018','rabaz','Radian6','RankSonicSiteAuditor/','rating','readability/','reader','realdownload/','reaper','ReGet','responsecodetest/','retrieve','rico/','Riddler','Rival IQ','Rivva','RMA/1\\.0','RoboPal','Robosourcer','robozilla/','rotondo/','rpt-httpclient/','RSurf15a','samualt9','saucenao/','SBIder','scan','scooter','ScoutAbout','scoutant/','ScoutJet','scoutmaster','scrape','Scrapy','Scrubby','search','Seeker\\.lookseek\\.com','seer','semaforo\\.net','semager/','semanticdiscovery','seo-nastroj\\.cz','SEOCentro','SEOstats','Seznam screenshot-generator','Shagseeker','ShopWiki','Siigle Orumcex','SimplyFast\\.info','Simpy','siphon','Site Server','Site24x7','SiteBar','SiteCondor','siteexplorer\\.info','Siteimprove','SiteRecon','SiteSnagger','sitesucker/','SiteUptime\\.com','SiteXpert','sitexy\\.com','skampy/','skimpy/','SkypeUriPreview','skywalker/','slarp/','slider\\.com','slurp','smartdownload/','smartwit\\.com','Snacktory','Snappy','sniff','sogou','sohu agent','somewhere','speeddownload/','speedy','speng','Sphere Scout','Sphider','spider','spinne/','spy','squidclam','Squider','Sqworm','SSurf15a','StackRambler','stamina/','StatusCake','suchbaer\\.de','summify','SuperCleaner','SurferF3','SurfMaster','suzuran','sweep','synapse','syncit/x\\.x','szukacz/','T-H-U-N-D-E-R-S-T-O-N-E','tags2dir\\.com/','Tagword','Talkro Web-Shot','targetblaster\\.com/','TargetSeek','Teleport Pro','teoma','Teradex Mapper','Theophrastus','thumb','TinEye','tkensaku/x\\.x\\(http://www\\.tkensaku\\.com/q\\.html\\)','tracker','truwoGPS','TSurf15a','tuezilla','tumblr/','Twingly Recon','Twotrees Reactive Filter','TygoProwler','Ultraseek','Under the Rainbow','unknownght\\.com','UofTDB_experiment','updated','url','user-agent','utility','utorrent/','Vagabondo','vakes/','vb wininet','venus/fedoraplanet','verifier','verify','Version: xxxx Type:xx','versus','verzamelgids/','viking','vkshare','voltron','vonna','Vortex','voyager-hc/','VYU2','W3C-mobileOK/','w3c-webcon/','W3C_Unicorn/','w3dt\\.net','Wappalyzer','warez','Watchfire WebXM','wavefire/','Waypath Scout','wbsrch\\.com','Web Snooper','web-bekannt','webbandit/','webbug/','Webclipping\\.com','webcollage','WebCompass','webcookies','webcorp/','webcraft','WebDataStats/','Webglimpse','webgobbler/','webinator','weblight/','Weblog Attitude Diffusion','webmastercoffee/','webminer/x\\.x','webmon ','WebPix','Website Explorer','Websnapr/','Websquash\\.com','webstat/','Webster v0\\.','webstripper/','webtrafficexpress/x\\.0','webtrends/','WebVac','webval/','Webverzeichnis\\.de','wf84','WFARC','wget','whatsapp','whatsmyip\\.org','whatsup/x\\.x','whatuseek_winona/','Whizbang','whoami','whoiam','Wildsoft Surfer','WinGet','WinHTTP','wish-project','WomlpeFactory','WordPress\\.com mShots','WorldLight','worqmada/','worth','wotbox','WoW Lemmings Kathune','WSN Links','wusage/x\\.0@boutell\\.com','wwlib/linux','www-mechanize/','www\\.ackerm\\.com','www\\.alertra\\.com','www\\.arianna\\.it','www\\.ba\\.be','www\\.de\\.com','www\\.evri\\.com/evrinid','www\\.gozilla\\.com','www\\.idealobserver\\.com','www\\.iltrovatore\\.it','www\\.iskanie\\.com','www\\.kosmix\\.com','www\\.megaproxy\\.com','www\\.moreover\\.com','www\\.mowser\\.com','www\\.nearsoftware\\.com','www\\.ssllabs\\.com','wwwc/','wwwoffle/','wwwster/','wxDownload Fast','Xenu Link Sleuth',"Xenu's Link Sleuth",'xirq/','XML Sitemaps Generator','xrl/','Xylix','Y!J-ASR','y!j-srd/','y!oasis/test','yacy','yahoo','YandeG','yandex','yanga','yarienavoir\\.net/','yeti','Yoleo','Yoono','youtube-dl','Zao','Zearchit','zedzo\\.digest/','zeus','zgrab','Zippy','ZnajdzFoto/Image','ZyBorg','googlebot','Googlebot-Mobile','Googlebot-Image','bingbot','java','curl','Python-urllib','libwww','phpcrawl','msnbot','jyxobot','FAST-WebCrawler','FAST Enterprise Crawler','seekbot','gigablast','exabot','ngbot','ia_archiver','GingerCrawler','webcrawler','grub.org','UsineNouvelleCrawler','antibot','netresearchserver','bibnum.bnf','msrbot','yacybot','AISearchBot','tagoobot','MJ12bot','dotbot','woriobot','buzzbot','mlbot','yandexbot','purebot','Linguee Bot','Voyager','voilabot','baiduspider','citeseerxbot','spbot','twengabot','turnitinbot','scribdbot','sitebot','Adidxbot','blekkobot','dotbot','Mail.RU_Bot','discobot','europarchive.org','NerdByNature.Bot','sistrix crawler','ahrefsbot','domaincrawler','wbsearchbot','ccbot','edisterbot','seznambot','ec2linkfinder','gslfbot','aihitbot','intelium_bot','RetrevoPageAnalyzer','lb-spider','lssbot','careerbot','wocbot','DuckDuckBot','lssrocketcrawler','webcompanycrawler','acoonbot','openindexspider','gnam gnam spider','web-archive-net.com.bot','backlinkcrawler','content crawler spider','toplistbot','seokicks-robot','it2media-domain-crawler','ip-web-crawler.com','siteexplorer.info','elisabot','blexbot','arabot','WeSEE:Search','niki-bot','CrystalSemanticsBot','rogerbot','360Spider','psbot','InterfaxScanBot','g00g1e.net','GrapeshotCrawler','urlappendbot','brainobot','fr-crawler','SimpleCrawler','Livelapbot','Twitterbot','cXensebot','smtbot','bnf.fr_bot','A6-Indexer','Facebot','Twitterbot','OrangeBot','memorybot','AdvBot','MegaIndex','SemanticScholarBot','nerdybot','xovibot','archive.org_bot','Applebot','TweetmemeBot','crawler4j','findxbot','SemrushBot','yoozBot','lipperhey','Domain Re-Animator Bot'];try{new RegExp('(?<! cu)bot').test('dangerbot');list.splice(list.lastIndexOf('bot'),1);list.push('(?<! cu)bot')}catch(error){}var regex=new RegExp('('+list.join('|')+')','i');function isbot(userAgent){return regex.test(userAgent)}var PrivateWindow={then:function then(){}};if('Promise'in window&&'fetch'in window){PrivateWindow=Promise.resolve(false)}function isPrivateWindow(){return PrivateWindow}function pageView(inputParams){var params=deepCopy(inputParams);params.page_url=window.location.href;params.page_title=document.title;sendDeviceEvent('page_view_events',params)}function sendCartEvents(inputParams,event_type){var params=deepCopy(inputParams);delete params.cartItems;var event_id=generateUUID();params.event_type=event_type;params.event_id=event_id;sendDeviceEvent('shopping_cart_events',params)}function addToCart(inputParams){sendCartEvents(inputParams,'add_to_cart')}function removeFromCart(inputParams){sendCartEvents(inputParams,'remove_from_cart')}function viewCart(inputParams){sendCartEvents(inputParams,'view_cart')}function beginCheckout(inputParams){sendCartEvents(inputParams,'begin_checkout')}function order(inputParams){var params=deepCopy(inputParams);delete params.cartItems;params.event_type='order';sendDeviceEvent('order_events',params);var cartEventParams={event_type:'order',event_id:generateUUID()};sendDeviceEvent('shopping_cart_events',cartEventParams);if(inputParams.cartItems){var _iterator=_createForOfIteratorHelper(inputParams.cartItems),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var product=_step.value;product.order_id=params.order_id;sendDeviceEvent('order_events_detail',product)}}catch(err){_iterator.e(err)}finally{_iterator.f()}}}function cancelOrder(inputParams){var params=deepCopy(inputParams);delete params.cartItems;params.event_type='cancel';params.total_amount=-params.total_amount;sendDeviceEvent('order_events',params);if(inputParams.cartItems){var _iterator2=_createForOfIteratorHelper(inputParams.cartItems),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var product=_step2.value;product.order_id=params.order_id;sendDeviceEvent('order_events_detail',product)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}}function search(inputParams){var params=deepCopy(inputParams);sendDeviceEvent('search_events',params)}function sendWishlistEvents(inputParams,event_type){var params=deepCopy(inputParams);delete params.items;var event_id=generateUUID();params.event_type=event_type;params.event_id=event_id;sendDeviceEvent('wishlist_events',params);if(inputParams.items){var _iterator3=_createForOfIteratorHelper(inputParams.items),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var product=_step3.value;product.event_id=event_id;sendDeviceEvent('wishlist_events_detail',product)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}}}function addToWishlist(inputParams){sendWishlistEvents(inputParams,'add')}function removeFromWishlist(inputParams){sendWishlistEvents(inputParams,'remove')}var ecommFunctions=Object.freeze({__proto__:null,pageView:pageView,addToCart:addToCart,removeFromCart:removeFromCart,viewCart:viewCart,beginCheckout:beginCheckout,order:order,cancelOrder:cancelOrder,search:search,addToWishlist:addToWishlist,removeFromWishlist:removeFromWishlist});function setTagsFn(tagsArray){if(!Array.isArray(tagsArray)){logError("setTags method parameters is missing or incorrect.");return}var invalid=false;for(var i=0;i<tagsArray.length;i++){if(!tagsArray[i].hasOwnProperty("tag")){invalid=true;break}if(tagsArray[i].hasOwnProperty("changeTime")){if(!isNaN(Date.parse(tagsArray[i].changeTime))&&!isIsoDate(tagsArray[i].changeTime)){tagsArray[i].changeTime=new Date(tagsArray[i].changeTime).toISOString()}}if(tagsArray[i].hasOwnProperty("removeTime")){if(!isNaN(Date.parse(tagsArray[i].removeTime))&&!isIsoDate(tagsArray[i].removeTime)){tagsArray[i].removeTime=new Date(tagsArray[i].removeTime).toISOString()}}}if(invalid){logError("setTags method parameters is missing or incorrect.");return}var setTagsObj={accountName:"marham",key:getDeviceId(),tags:tagsArray};logInfo(setTagsObj);return fetch('https://push.dengage.com/api/setTags',{method:'POST',mode:'cors',cache:'no-cache',credentials:'omit',headers:{'Content-Type':'text/plain'},body:JSON.stringify(setTagsObj)}).catch((function(e){logError(e.toString())}))}var globalJsCode='<script'+'>'+"\nvar Dn = {\n    dismiss: function() {\n      window.parent.postMessage({action: 'dismiss'}, '*');\n    },\n    openUrl: function(url, newTab) {\n      window.parent.postMessage({action: 'openUrl', url: url, newTab: newTab}, '*');\n    },\n    sendClick: function(buttonId) {\n      window.parent.postMessage({action: 'sendClick', buttonId: buttonId}, '*');\n    },\n    close: function() {\n      window.parent.postMessage({action: 'close'}, '*');\n    },\n    setTags: function(tags) {\n      window.parent.postMessage({action: 'setTags', tags: tags}, '*');\n    },\n};\n\nfunction getDocHeight() {\n    doc = document;\n    var body = doc.body,\n        html = doc.documentElement;\n    var height = Math.max(\n        body.scrollHeight,\n        body.offsetHeight,\n        //html.clientHeight,\n        //html.scrollHeight,\n        html.offsetHeight,\n    );\n    return height;\n}\n\nvar oldHeight = 0;\nvar checkCount = 0;\nfunction checkHeight() {\n    var height = getDocHeight();\n    if (oldHeight != height) {\n        oldHeight = height;\n        window.parent.postMessage({action: 'height', value: height}, '*');\n    }\n    checkCount++;\n    setTimeout(checkHeight, checkCount > 20 ? 300 : 100);\n}\nsetTimeout(checkHeight, 100);\n\nvar enableClicks = false;\nsetTimeout(function () {\n    enableClicks = true;\n}, 1500);\n"+'<'+'/script'+'>'+'</head>';var globalCssCode='<head><style'+'>'+"\nhtml, body, div, span, applet, object, iframe,\nh1, h2, h3, h4, h5, h6, p, blockquote, pre,\na, abbr, acronym, address, big, cite, code,\ndel, dfn, em, img, ins, kbd, q, s, samp,\nsmall, strike, strong, sub, sup, tt, var,\nb, u, i, center,\ndl, dt, dd, ol, ul, li,\nfieldset, form, label, legend,\ntable, caption, tbody, tfoot, thead, tr, th, td,\narticle, aside, canvas, details, embed, \nfigure, figcaption, footer, header, hgroup, \nmenu, nav, output, ruby, section, summary,\ntime, mark, audio, video {\n\tmargin: 0;\n\tpadding: 0;\n\tborder: 0;\n\tvertical-align: baseline;\n}\narticle, aside, details, figcaption, figure, \nfooter, header, hgroup, menu, nav, section {\n\tdisplay: block;\n}\nbody {\n\tline-height: 1;\n}\nol, ul {\n\tlist-style: none;\n}\nblockquote, q {\n\tquotes: none;\n}\nblockquote:before, blockquote:after,\nq:before, q:after {\n\tcontent: '';\n\tcontent: none;\n}\ntable {\n\tborder-collapse: collapse;\n\tborder-spacing: 0;\n}\n*,\n*::before,\n*::after {\n\tbox-sizing: border-box;\n}\n"+'</style'+'>';function getMessageHtmlAsUri(content,msgId){var html=content.props.html.replace('</head>',globalJsCode).replace('<head>',globalCssCode);var uri='data:text/html,'+encodeURIComponent(html);return uri}function generateBannerHtml(content,msgId){var messageHtml=getMessageHtmlAsUri(content);var html="\n<div class=\"dn-iframe-container\">\n    <iframe src=\"".concat(messageHtml,"\" style=\"border: none; width: 100%; height: 20px; display: block;\"></iframe>\n</div> \n    \n<style>\nbody > .dengage-onsite-banner {\n    box-shadow: 0 3px 6px 0 rgba(0, 0, 0, 0.2) !important;\n    position: ").concat(content.props.isFixed?'fixed':'absolute'," !important;\n    width: 100% !important;\n    z-index: 100000000 !important;\n    left: 0 !important;\n}\nbody > .dengage-onsite-banner.dn-top {\n    top: -200px !important;\n}\nbody > .dengage-onsite-banner.dn-bottom {\n    bottom: -200px !important;\n}\nbody > .dengage-onsite-banner.dn-top.dn-opened {\n    top: 0 !important;\n}\nbody > .dengage-onsite-banner.dn-bottom.dn-opened {\n    bottom: 0 !important;\n}\n\n.dn-iframe-container {\n    width: 100% !important;\n    min-height: 20px;\n}\n</style>\n");return html}function generateModalHtml(content,msgId){var messageHtml=getMessageHtmlAsUri(content);var html="\n<div class=\"dn-onsite-modal\">\n    <div class=\"dn-iframe-container\">\n        <iframe src=\"".concat(messageHtml,"\" style=\"border: none; width: 100%; height: 20px;\"></iframe>\n    </div>\n    <div  class=\"dn-btn-popup-close\" style=\"").concat(content.props.isCloseButtonActive==false?'display:none;':'',"\">\n        <svg width=\"32\" height=\"32\" viewBox=\"0 0 32 32\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n            <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M22.0303 11.0296C22.3232 10.7367 22.3232 10.2618 22.0303 9.96894C21.7374 9.67604 21.2626 9.67604 20.9697 9.96894L16 14.9386L11.0303 9.96894C10.7374 9.67604 10.2626 9.67604 9.96967 9.96894C9.67678 10.2618 9.67678 10.7367 9.96967 11.0296L14.9393 15.9993L9.96967 20.9689C9.67678 21.2618 9.67678 21.7367 9.96967 22.0296C10.2626 22.3225 10.7374 22.3225 11.0303 22.0296L16 17.0599L20.9697 22.0296C21.2626 22.3225 21.7374 22.3225 22.0303 22.0296C22.3232 21.7367 22.3232 21.2618 22.0303 20.9689L17.0607 15.9993L22.0303 11.0296Z\" fill=\"").concat(content.props.closeButtonColor,"\" fill-opacity=\"0.7\"/>\n        </svg>\n    </div>\n</div>\n    \n<style>\nbody > .dengage-onsite-overlay {\n    display: block !important;\n    position: fixed !important;\n    z-index: 100000000 !important;\n    left: 0 !important;\n    top: 0 !important;\n    width: 100% !important;\n    height: 100% !important;\n    overflow: hidden !important;\n    padding: 0 !important;\n    margin: 0 !important;\n    background-color: rgba(0,0,0,0.3) !important;\n    line-height: 100vh !important;\n    text-align: center !important;\n}\n\n.dn-onsite-modal {\n    margin: 0 auto !important;\n    display: inline-block !important;\n    vertical-align: middle !important;\n    width: calc(100vw - 20px) !important;\n    max-width: ").concat(content.props.maxWidth,"px !important;\n    max-height: calc(100vh - 20px) !important;\n    height: auto  !important;\n    line-height: normal !important;\n}\n\n.dn-iframe-container {\n    width: 100% !important;\n    min-height: 20px !important;\n    overflow: hidden !important;\n    border-radius: ").concat(content.props.cardRadius,"px !important;\n    height: auto  !important;\n    line-height: normal !important;\n}\n\n\n\n\n.dn-btn-popup-close {\n    position: relative;\n    color: #aaaaaa !important;\n    float: right !important;\n    height: 26px;\n}\n.dn-btn-popup-close:hover,\n.dn-btn-popup-close:focus {\n    color: #000 !important;\n    text-decoration: none !important;\n    cursor: pointer !important;\n}\n.dn-btn-popup-close:hover {\n    cursor: pointer !important;\n}\n</style>\n");return html}function showOnSiteCustomHtmlPromt(messagedetails){var content=messagedetails.message_json.content;var container=document.createElement("div");var dismissCallback=null;var clickCallback=null;messagedetails.smsg_id.replace(/\-/g,'_');if(content.props.position=='MIDDLE'){container.id="dengage-onsite-overlay";container.className="dengage-onsite-overlay";container.innerHTML=generateModalHtml(content);if(content.props.dismissOnClickOutside){setTimeout((function(){container.addEventListener('click',(function(){if(dismissCallback){dismissCallback(messagedetails)}close()}))}),1500)}if(content.props.isCloseButtonActive){var closeBtn=container.getElementsByClassName('dn-btn-popup-close')[0];closeBtn.addEventListener('click',(function(){if(dismissCallback){dismissCallback(messagedetails)}close()}))}}else{var className="dengage-onsite-banner";container.id="dengage-onsite-banner";if(content.props.position=='TOP'){className+=" dn-top"}if(content.props.position=='BOTTOM'){className+=" dn-bottom"}container.className=className;container.innerHTML=generateBannerHtml(content);setTimeout((function(){container.className+=" dn-opened"}),50)}document.body.appendChild(container);var iframeElement=null;function MessageHandler(event){if(iframeElement&&event.source===iframeElement.contentWindow){var data=event.data;if(data.action=='dismiss'){if(dismissCallback){dismissCallback(messagedetails)}close()}else if(data.action=='openUrl'){window.open(data.url,data.newTab?'_blank':'_self')}else if(data.action=='sendClick'){if(clickCallback){clickCallback(messagedetails)}}else if(data.action=='close'){close()}else if(data.action=='setTags');else if(data.action=='height'){iframeElement.style.height=data.value+'px'}}}setTimeout((function(){iframeElement=container.getElementsByTagName('iframe')[0];window.addEventListener("message",MessageHandler,false)}),10);function close(){container.classList.remove("dn-opened");setTimeout((function(){document.body.removeChild(container);window.removeEventListener("message",MessageHandler)}),10)}return{onDismissPopup:function onDismissPopup(callback){dismissCallback=callback},onClickMessage:function onClickMessage(callback){clickCallback=callback}}}function sendOnsiteEvent(messageObject,type){if(!messageObject.message_json.messageDetails){return}var deviceId=getDeviceId();var contactKey=getContactKey();var url=new URL('https://push.dengage.com/api/onsite/'+(type=='DISMISS'?'setAsDismissed':type=='DISPLAY'?'setAsDisplayed':'setAsClicked'));var data={acc:"marham",cdkey:contactKey||deviceId,type:contactKey?'c':'d',did:deviceId,message_details:messageObject.message_json.messageDetails,button_id:messageObject.button_id};url.search=new URLSearchParams(data).toString();fetch(url,{method:'POST',mode:'cors',cache:'no-cache',credentials:'omit',headers:{'Content-Type':'text/plain'}}).catch((function(e){logError(e.toString())}))}var initialized=false;function GetNextMessageDisplayTime(){return storage.getInt('next_onsite_message_display_time')}function UpdateMessageDisplayTime(msgobj,updatedtime){var updatedMessages=[];var _iterator=_createForOfIteratorHelper(GetOnSiteMessagesFromLocalStorage()),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var messageObject=_step.value;if(msgobj.smsg_id==messageObject.smsg_id){messageObject.next_display_time=updatedtime.getTime()}updatedMessages.push(messageObject)}}catch(err){_iterator.e(err)}finally{_iterator.f()}SortAndSaveLocalStorage(updatedMessages)}function GetOnSiteMinSecBetweenMessages(){var minutes='300';if(storage.get('dn_debug')=='true'){return 0}return parseInt(minutes)}function GetOnSiteMessagesFromLocalStorage(){var messages=localStorage.getItem('dengage_onsite_messages')||'[]';return JSON.parse(messages)}function GetOnsiteMessageInterval(){var minutes='30';if(storage.get('dn_debug')=='true'){return 0}return parseInt(minutes)}function CheckGetMessageIntervalReached(){var messageGetTimeStamp=localStorage.getItem('dengage_onsite_get_message_timestamp');if(!messageGetTimeStamp){return true}var currentdate=new Date;var messageIntervalTimeStamp=new Date(parseInt(messageGetTimeStamp));var diffMs=currentdate.getTime()-messageIntervalTimeStamp.getTime();var diffMins=diffMs/6e4;if(diffMins>=GetOnsiteMessageInterval()){return true}return false}function GetOnSiteMessages(){var deviceId=getDeviceId();var contactKey=getContactKey();var url=new URL('https://push.dengage.com/api/onsite/getMessages');var reqParams={acc:'42ad9511-71f0-0171-6c66-6b5bf6c6c944',cdkey:contactKey||deviceId,type:contactKey?'c':'d',did:deviceId};url.search=new URLSearchParams(reqParams).toString();var request=fetch(url,{method:'GET',mode:'cors',cache:'no-cache',credentials:'omit',headers:{'Content-Type':'text/plain'}}).then((function(response){localStorage.setItem('dengage_onsite_get_message_timestamp',(new Date).getTime());return response.json()})).then((function(data){data.forEach((function(d){if(typeof d.message_json=='string'){d.message_json=JSON.parse(d.message_json)}}));logInfo('OnsitegetMessages response ',data);return data})).catch((function(e){logError('Onsite getMessage Error',e.message);return null}));return request}var isShowing=false;function onDismissCallback(messageObject){isShowing=false;sendOnsiteEvent(messageObject,'DISMISS');var message_json=messageObject.message_json;if(message_json.displayTiming.showEveryXMinutes==0){DeleteMessageFromLocalStorage(messageObject)}else{var nextDisplayTime=new Date;nextDisplayTime.setMinutes(nextDisplayTime.getMinutes()+parseInt(message_json.displayTiming.showEveryXMinutes));UpdateMessageDisplayTime(messageObject,nextDisplayTime)}}function onClickCallback(messageObject){isShowing=false;sendOnsiteEvent(messageObject,'CLICK');DeleteMessageFromLocalStorage(messageObject)}function GetAndShowPopus(pageUrl,screenName){if(isShowing){return}var now=(new Date).getTime();var _iterator2=_createForOfIteratorHelper(GetOnSiteMessagesFromLocalStorage()),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var messageObject=_step2.value;if(messageObject.message_json.displayTiming.triggerBy!='NAVIGATION'){continue}if(Date.parse(messageObject.message_json.expireDate)<=Date.parse((new Date).toISOString())){DeleteMessageFromLocalStorage(messageObject);continue}if((messageObject.next_display_time||0)<now){var showMessage=false;var cond=messageObject.message_json.displayCondition;if(cond.whenToDisplay=='HOME_PAGE'){var _url=new URL(pageUrl);if(_url.pathname=='/'&&(_url.hash==''||_url.hash=='#/')){showMessage=true}}else if(cond.whenToDisplay=='SPECIFIC_PAGE'){if(ValidateFilters(cond.screenNameFilters,screenName)||ValidateFilters(cond.pageUrlFilters,pageUrl)){showMessage=true}}else{showMessage=true}if(showMessage){isShowing=true;setTimeout((function(){var promt=null;if(messageObject.message_json.content.type.toLowerCase()=='html'){promt=showOnSiteCustomHtmlPromt(messageObject)}if(promt!=null){promt.onDismissPopup(onDismissCallback);promt.onClickMessage(onClickCallback);sendOnsiteEvent(messageObject,'DISPLAY');if(GetOnSiteMinSecBetweenMessages()>0){var nextDisplayTime=new Date;nextDisplayTime.setSeconds(nextDisplayTime.getSeconds()+GetOnSiteMinSecBetweenMessages());localStorage.setItem('next_onsite_message_display_time',nextDisplayTime.getTime())}}}),parseInt(messageObject.message_json.displayTiming.delay||0)*1e3);break}}}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}function ValidateFilters(filters,currentValue){for(var i=0;i<filters.length;i++){switch(filters[i].operator){case'EQUALS':{if(filters[i].value[0]==currentValue)return true}break;case'NOT_EQUALS':{if(filters[i].value[0]!=currentValue)return true}break;case'LIKE':{if(currentValue.includes(filters[i].value[0]))return true}break;case'NOT_LIKE':{if(!currentValue.includes(filters[i].value[0]))return true}break;case'STARTS_WITH':{if(currentValue.startsWith(filters[i].value[0]))return true}break;case'NOT_STARTS_WITH':{if(!currentValue.startsWith(filters[i].value[0]))return true}break;case'ENDS_WITH':{if(currentValue.endsWith(filters[i].value[0]))return true}break;case'NOT_ENDS_WITH':{if(!currentValue.endsWith(filters[i].value[0]))return true}break;case'IN':{if(filters[i].value.includes(currentValue))return true}break;case'NOT_IN':{if(!filters[i].value.includes(currentValue))return true}break;case'GREATER_THAN':{if(currentValue>filters[i].value[0])return true}break;case'GREATER_EQUAL':{if(currentValue>=filters[i].value[0])return true}break;case'LESS_THAN':{if(currentValue<filters[i].value[0])return true}break;case'LESS_EQUAL':{if(currentValue<=filters[i].value[0])return true}break}}return false}function AddNewMessagesToStorage(messages){var existingMessages=JSON.parse(localStorage.getItem('dengage_onsite_messages')||'[]');var lastMessageCreated=storage.getInt('dengage_onsite_last_created');messages=messages.filter((function(m){return new Date(m.created).valueOf()>lastMessageCreated})).filter((function(m){return existingMessages.filter((function(em){return em.smsg_id==m.smsg_id})).length==0}));messages=messages.concat(existingMessages);for(var i=0;i<messages.length;i++){var createVal=new Date(messages[i].created).valueOf();if(createVal>lastMessageCreated){lastMessageCreated=createVal}}storage.set('dengage_onsite_last_created',lastMessageCreated);SortAndSaveLocalStorage(messages)}function SortAndSaveLocalStorage(messages){messages.forEach((function(msg){var cond=msg.message_json.displayCondition;cond.screenNameFilters=cond.screenNameFilters||[];cond.pageUrlFilters=cond.pageUrlFilters||[];cond.whenToDisplay=cond.whenToDisplay||'ANY_PAGE'}));var sortedMessages=messages.sort(MessageCompare);localStorage.setItem('dengage_onsite_messages',JSON.stringify(sortedMessages))}function MessageCompare(a,b){if(a.message_json.priority<b.message_json.priority){return-1}else if(a.message_json.priority>b.message_json.priority){return 1}else{if(a.message_json.displayCondition.whenToDisplay=='SPECIFIC_PAGE'&&a.message_json.displayCondition.whenToDisplay!='SPECIFIC_PAGE'){return-1}else{if(a.message_json.expireDate<b.message_json.expireDate){return-1}else if(a.message_json.expireDate>b.message_json.expireDate){return 1}else{return 0}}}}function DeleteMessageFromLocalStorage(m_obj){var localMessages=GetOnSiteMessagesFromLocalStorage();for(var i=0;i<localMessages.length;i++){var msg=localMessages[i];if(msg.smsg_id==m_obj.smsg_id){localMessages.splice(i,1);break}}SortAndSaveLocalStorage(localMessages)}function start(){if(CheckGetMessageIntervalReached()){GetOnSiteMessages().then((function(messages){AddNewMessagesToStorage(messages);initialized=true}))}else{initialized=true}window.addEventListener('message',(function(event){if(_typeof(event.data)=='object'&&event.data._dn_onsite_message){var message={smsg_id:'aaaa',message_json:{content:event.data.message}};var result=showOnSiteCustomHtmlPromt(message);result.onDismissPopup((function(a){console.log(a)}));result.onClickMessage((function(a){console.log(a)}))}}))}function setNavigation(screenName){waitUntil((function(){return!!initialized})).then((function(){if(GetNextMessageDisplayTime()>=(new Date).getTime()){return}var pageUrl=document.location.href;GetAndShowPopus(pageUrl,screenName||'')}))}function startSession(){var queryString={utm_source:getQueryStringParameter('utm_source')||null,utm_medium:getQueryStringParameter('utm_medium')||null,utm_campaign:getQueryStringParameter('utm_campaign')||null,utm_content:getQueryStringParameter('utm_content')||null,utm_term:getQueryStringParameter('utm_term')||null,channel:getQueryStringParameter('dn_channel')||null,send_id:getQueryStringParameter('dn_send_id')||null};if(isNewSession()){var session_info=objectAssign({},{referer:document.referrer},queryString);storage.sessionSet('dengage_session_query_string',window.location.search);sendDeviceEvent('session_info',session_info)}var debug=getQueryStringParameter('dn_debug')||null;if(debug=='true'){storage.set('dn_debug','true')}var contact_key=getQueryStringParameter('dn_contact_key')||null;if(contact_key){setContactKey(contact_key)}}var publicMethods={initialize:function initialize(params,callback){var cb=function cb(){start$2();if(callback){callback()}};if(params&&params.logLevel){setLogLevel(params.logLevel)}if(isPushEnabled()){if(_typeof(params)=='object'){pushClient.setParams(params)}runOnWindowLoaded((function(){start$1(cb)}))}else{cb()}if(checkOnSite(false)){runOnWindowLoaded((function(){start()}))}},setLogLevel:function setLogLevel$1(val,callback){setLogLevel(val);if(callback){callback()}},showNativePrompt:function showNativePrompt$1(callback){if(!isPushEnabled()){return}showNativePrompt().then((function(result){if(callback){callback(result)}}))},showCustomPrompt:function showCustomPrompt$1(callback){if(!isPushEnabled()){return}showCustomPrompt().then((function(result){if(callback){callback(result)}}))},getNotificationPermission:function getNotificationPermission(callback){if(!isPushEnabled()){return}if(callback){callback(pushClient.getPermission())}},getToken:function getToken$1(callback){if(!isPushEnabled()){return}if(callback){callback(getToken())}},isPushNotificationsSupported:function isPushNotificationsSupported(callback){if(!checkPush(true)){return}if(callback){callback(pushClient.detected())}},getDeviceId:function getDeviceId$1(callback){if(callback){callback(getDeviceId())}},setDeviceId:function setDeviceId$1(val,callback){setDeviceId(val);if(callback){callback()}},provideUserConsent:function provideUserConsent(){},sendDeviceEvent:function sendDeviceEvent$1(table,data,callback){sendDeviceEvent(table,data).then((function(){if(callback){callback()}}))},sendCustomEvent:function sendCustomEvent$1(table,key,data,callback){sendCustomEvent(table,key,data).then((function(){if(callback){callback()}}))},setContactKey:function setContactKey$1(val,callback){setContactKey(val);if(callback){callback()}},getContactKey:function getContactKey$1(callback){if(callback){callback(getContactKey())}},setUserPermission:function setUserPermission$1(val,callback){setUserPermission(val);if(callback){callback()}},getUserPermission:function getUserPermission$1(callback){if(callback){callback(getUserPermission())}},setTags:function setTags(params,callback){setTagsFn(params).then((function(){if(callback){callback()}}))},setNavigation:function setNavigation$1(params){if(!checkOnSite(true)){return}if(params==undefined){params={}}setNavigation(params)},setCountry:function setCountry$1(val,callback){setCountry(val);if(callback){callback()}},getCountry:function getCountry$1(callback){if(callback){callback(getCountry())}}};if('Promise'in window&&'fetch'in window){if(window._Dn_globaL_){throw new Error('Dengage SDK is already loaded.')}var currentScript=document.currentScript||function(){var scripts=document.getElementsByTagName('script');return scripts[scripts.length-1]}();var scriptUrl=new URL(currentScript.src);window._Dn_globaL_={scriptTag:currentScript,domain:scriptUrl.host,loadParams:{init:scriptUrl.searchParams.get('init')=='true',swUrl:scriptUrl.searchParams.get('sw_url')||undefined,swScope:scriptUrl.searchParams.get('sw_scope')||undefined,useSwQueryParams:scriptUrl.searchParams.get('use_sw_query_params')||undefined,logLevel:scriptUrl.searchParams.get('log_level')||undefined},logLevel:'',cookieData:{webpushDomain:''},customFunctions:{}};if(appSettings.subdomainDataSync){var cookieData=getCookie('_dn_data');cookieData=parseCookieData(cookieData);if(cookieData){setDeviceId(cookieData.deviceId);setContactKey(cookieData.contactKey);setTokenType(cookieData.tokenType);setToken(cookieData.token);setWebSubscription(cookieData.webSubscription);window._Dn_globaL_.cookieData=cookieData}}if(storage.isAvailable()){isBotOrPrivateWindow().then((function(botOrPrivate){if(botOrPrivate!==true){var q=[];if(window.dengage&&window.dengage.q){q=window.dengage.q}if(appSettings.triggerNavigationOnLoad){q.push(['setNavigation'])}startSession();window.dengage=function(){try{if(typeof arguments[0]!='string'){logError('dengage function requires function name as string');return}if(arguments[0].indexOf('ec:')==0){if(typeof ecommFunctions[arguments[0].replace('ec:','')]!='function'){logError('There is no function called '+arguments[0]);return}ecommFunctions[arguments[0].replace('ec:','')].apply(this,Array.prototype.slice.call(arguments,1))}else if(arguments[0].indexOf('custom:')==0){if(typeof window._Dn_globaL_.customFunctions[arguments[0].replace('custom:','')]!='function'){logError('There is no function called '+arguments[0]);return}window._Dn_globaL_.customFunctions[arguments[0].replace('custom:','')].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof publicMethods[arguments[0]]!='function'){logError('There is no function called '+arguments[0]);return}publicMethods[arguments[0]].apply(this,Array.prototype.slice.call(arguments,1))}}catch(e){logError(e.toString())}};if(window._Dn_globaL_.loadParams.init){dengage('initialize',window._Dn_globaL_.loadParams)}q.forEach((function(command){window.dengage.apply(this,command)}));window.dnQueue=window.dnQueue||[];window.dnQueue.forEach((function(func){func()}));window.dnQueue.push=function(func){func()};window.dataLayer=window.dataLayer||[]}}))}}function isBotOrPrivateWindow(){if(isbot(navigator.userAgent)){return Promise.resolve(true)}else{return isPrivateWindow()}}(function(){var f=/\[object (Boolean|Number|String|Function|Array|Date|RegExp|Arguments)\]/;function g(a){return null==a?String(a):(a=f.exec(Object.prototype.toString.call(Object(a))))?a[1].toLowerCase():"object"}function m(a,b){return Object.prototype.hasOwnProperty.call(Object(a),b)}function n(a){if(!a||"object"!=g(a)||a.nodeType||a==a.window)return!1;try{if(a.constructor&&!m(a,"constructor")&&!m(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}for(var b in a){}return void 0===b||m(a,b)}function p(a,b){var c={},d=c;a=a.split(".");for(var e=0;e<a.length-1;e++){d=d[a[e]]={}}d[a[a.length-1]]=b;return c}function q(a,b){var c=!a._clear,d;for(d in a){if(m(a,d)){var e=a[d];"array"===g(e)&&c?("array"===g(b[d])||(b[d]=[]),q(e,b[d])):n(e)&&c?(n(b[d])||(b[d]={}),q(e,b[d])):b[d]=e}}delete b._clear}function r(a,b,c){b=void 0===b?{}:b;"function"===typeof b?b={listener:b,listenToPast:void 0===c?!1:c,processNow:!0,commandProcessors:{}}:b={listener:b.listener||function(){},listenToPast:b.listenToPast||!1,processNow:void 0===b.processNow?!0:b.processNow,commandProcessors:b.commandProcessors||{}};this.a=a;this.l=b.listener;this.j=b.listenToPast;this.g=this.i=!1;this.c={};this.f=[];this.b=b.commandProcessors;this.h=u(this);var d=this.a.push,e=this;this.a.push=function(){var k=[].slice.call(arguments,0),l=d.apply(e.a,k);v(e,k);return l};b.processNow&&this.process()}r.prototype.process=function(){this.registerProcessor("set",(function(){var c={};1===arguments.length&&"object"===g(arguments[0])?c=arguments[0]:2===arguments.length&&"string"===g(arguments[0])&&(c=p(arguments[0],arguments[1]));return c}));this.i=!0;for(var a=this.a.length,b=0;b<a;b++){v(this,[this.a[b]],!this.j)}};r.prototype.get=function(a){var b=this.c;a=a.split(".");for(var c=0;c<a.length;c++){if(void 0===b[a[c]])return;b=b[a[c]]}return b};r.prototype.flatten=function(){this.a.splice(0,this.a.length);this.a[0]={};q(this.c,this.a[0])};r.prototype.registerProcessor=function(a,b){a in this.b||(this.b[a]=[]);this.b[a].push(b)};function v(a,b,c){c=void 0===c?!1:c;if(a.i&&(a.f.push.apply(a.f,b),!a.g))for(;0<a.f.length;){b=a.f.shift();if("array"===g(b))a:{var d=a.c;g(b[0]);for(var e=b[0].split("."),k=e.pop(),l=b.slice(1),h=0;h<e.length;h++){if(void 0===d[e[h]])break a;d=d[e[h]]}try{d[k].apply(d,l)}catch(w){}}else if("arguments"===g(b)){e=a;k=[];l=b[0];if(e.b[l])for(d=e.b[l].length,h=0;h<d;h++){k.push(e.b[l][h].apply(e.h,[].slice.call(b,1)))}a.f.push.apply(a.f,k)}else if("function"==typeof b)try{b.call(a.h)}catch(w){}else if(n(b))for(var t in b){q(p(t,b[t]),a.c)}else continue;c||(a.g=!0,a.l(a.c,b),a.g=!1)}}r.prototype.registerProcessor=r.prototype.registerProcessor;r.prototype.flatten=r.prototype.flatten;r.prototype.get=r.prototype.get;r.prototype.process=r.prototype.process;window.DataLayerHelper=r;function u(a){return{set:function set(b,c){q(p(b,c),a.c)},get:function get(b){return a.get(b)}}}function increaseScore(val){return val+(Math.sqrt(val)-val)/4}function storeRfmValues(rfmArray,userId){if(!userId){return}var vals=rfmArray.map((function(a){return a.parentCategoryId+';'+a.finalScore}));localStorage.setItem('_dn_rfm_'+userId,vals.join('|'))}function getRfmScores(userId){var vals=localStorage.getItem('_dn_rfm_'+userId);if(!vals){return[]}vals=vals.split('|');return vals.map((function(v){var parts=v.split(';');return{parentCategoryId:parseInt(parts[0]),finalScore:parseFloat(parts[1])}}))}window.dataLayer=window.dataLayer||[];function processDataLayer(model,message){var dataLayerRfmScores=this.get('buyerCategoryRFMScores');var userId=(this.get('loginStatus')=='login'?this.get('bId'):this.get('hapc'))||'';var catId=this.get('rCatId1');if(dataLayerRfmScores&&dataLayerRfmScores.length>0){storeRfmValues(dataLayerRfmScores,userId)}if(catId){var rfmScores=getRfmScores(userId);var found=false;for(var i=0;i<rfmScores.length;i++){if(rfmScores[i].parentCategoryId==catId){rfmScores[i].finalScore=increaseScore(rfmScores[i].finalScore);found=true}}if(!found){var newRfmScore={finalScore:.5,parentCategoryId:catId};rfmScores.push(newRfmScore)}storeRfmValues(rfmScores,userId)}}var dlHelper=new DataLayerHelper(window.dataLayer,{listener:processDataLayer});processDataLayer.call(dlHelper);function sortByRfms(sortedRfmScores,_arr){var array=_arr.slice();var result=[];for(var i=0;i<sortedRfmScores.length;i++){for(var j=0;j<array.length;j++){if(sortedRfmScores[i].parentCategoryId==array[j].bannerCategoryID){result.push(array[j]);array.splice(j,1);j--}}}array.sort((function(a,b){return(a.bannerSequence||1)-(b.bannerSequence||1)}));return result.concat(array)}window._Dn_globaL_.customFunctions.sortBanners=function(banners,callback){var array=banners.slice(1);var gender=dlHelper.get('gender');var userId=(dlHelper.get('loginStatus')=='login'?dlHelper.get('bId'):dlHelper.get('hapc'))||'';var rfmScores=getRfmScores(userId);console.log('RFM scores >> ',rfmScores);rfmScores.sort((function(a,b){return b.finalScore-a.finalScore}));var notPersonalized=[];for(var i=0;i<array.length;i++){if(array[i].personalized==false){notPersonalized.push(array[i]);array.splice(i,1);i--}}notPersonalized=sortByRfms(rfmScores,notPersonalized);var genderSelecteds=[];for(var j=0;j<array.length;j++){if(array[j].bannerType==gender||array[j].bannerType=='N'){genderSelecteds.push(array[j]);array.splice(j,1);j--}}genderSelecteds=sortByRfms(rfmScores,genderSelecteds);array=sortByRfms(rfmScores,array);console.log(notPersonalized);console.log(genderSelecteds);console.log(array);if(callback){callback(notPersonalized.concat(genderSelecteds).concat(array).slice(0,17))}}})();var __custom_js=function() {};try{__custom_js()}catch(e){}})();
